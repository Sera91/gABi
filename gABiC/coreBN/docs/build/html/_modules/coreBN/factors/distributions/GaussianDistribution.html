<!DOCTYPE html>
<html class="writer-html5" lang="English/Python">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coreBN.factors.distributions.GaussianDistribution &mdash; gABi 00.00.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            gABi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../modules.html">coreBN</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">gABi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">coreBN.factors.distributions.GaussianDistribution</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for coreBN.factors.distributions.GaussianDistribution</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">multivariate_normal</span>

<span class="kn">from</span> <span class="nn">coreBN.factors.distributions</span> <span class="kn">import</span> <span class="n">BaseDistribution</span>


<div class="viewcode-block" id="GaussianDistribution"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution">[docs]</a><span class="k">class</span> <span class="nc">GaussianDistribution</span><span class="p">(</span><span class="n">BaseDistribution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    In its most common representation, a multivariate Gaussian distribution</span>
<span class="sd">    over X1, X2, ..., Xn is characterized by an n-dimensional mean vector μ,</span>
<span class="sd">    and a symmetric n x n covariance matrix Σ.</span>

<span class="sd">    This is the base class for its representation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: iterable of any hashable python object</span>
<span class="sd">            The variables for which the distribution is defined.</span>

<span class="sd">        mean: list, array-like</span>
<span class="sd">            1-D array of size n where n is the number of variables.</span>

<span class="sd">        cov: n x n, 2-D array like</span>
<span class="sd">            n x n dimensional matrix where n is the number of variables.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...          mean=np.array([1, -3, 4]),</span>
<span class="sd">        ...          cov=np.array([[4, 2, -2],</span>
<span class="sd">        ...                        [2, 5, -5],</span>
<span class="sd">        ...                        [-2, -5, 8]]))</span>
<span class="sd">        &gt;&gt;&gt; dis.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dis.mean</span>
<span class="sd">        array([[ 1],</span>
<span class="sd">               [-3],</span>
<span class="sd">               [4]]))</span>
<span class="sd">        &gt;&gt;&gt; dis.cov</span>
<span class="sd">        array([[4, 2, -2],</span>
<span class="sd">               [2, 5, -5],</span>
<span class="sd">               [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; dis.assignment([0, 0, 0])</span>
<span class="sd">        0.0014805631279234139</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">N_var</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="p">(</span><span class="n">N_var</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">cov</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span> <span class="o">!=</span> <span class="n">N_var</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Length of mean_vector must be equal to the&quot;</span><span class="p">,</span> <span class="s2">&quot;number of variables.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">N_var</span><span class="p">,</span> <span class="n">N_var</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The Covariance matrix should be a square matrix  with order equal to the number of variables. Got: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, Expected: </span><span class="si">{</span><span class="p">(</span><span class="n">N_var</span><span class="p">,</span> <span class="n">N_var</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the probability density function(pdf).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        function: The probability density function of the distribution.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution</span>
<span class="sd">        &gt;&gt;&gt; dist = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...           mean=[1, -3, 4],</span>
<span class="sd">        ...           cov=[[4, 2, -2],</span>
<span class="sd">        ...                [2, 5, -5],</span>
<span class="sd">        ...                [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; dist.pdf</span>
<span class="sd">        &lt;function coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.pdf.&lt;locals&gt;.&lt;lambda&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; dist.pdf([0, 0, 0])</span>
<span class="sd">        0.0014805631279234139</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span>
            <span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">))[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span>
        <span class="p">)</span>

<div class="viewcode-block" id="GaussianDistribution.assignment"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.assignment">[docs]</a>    <span class="k">def</span> <span class="nf">assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the probability value of the PDF at the given parameter values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        *x: int, float</span>
<span class="sd">            The point at which the value of the pdf needs to be computed. The</span>
<span class="sd">            number of values passed should be equal to the number of variables</span>
<span class="sd">            in the distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float: float</span>
<span class="sd">            The probability value at the point.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution</span>
<span class="sd">        &gt;&gt;&gt; dist = GaussianDistribution(variables=[&#39;x1&#39;, &#39;x2&#39;],</span>
<span class="sd">        ...                             mean=[0, 0],</span>
<span class="sd">        ...                             cov=[[1, 0],</span>
<span class="sd">                                             [0, 1]])</span>
<span class="sd">        &gt;&gt;&gt; dist.assignment(0, 0)</span>
<span class="sd">        0.15915494309189535</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">precision_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the precision matrix of the distribution.</span>

<span class="sd">        Precision is defined as the inverse of the variance. This method returns</span>
<span class="sd">        the inverse matrix of the covariance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...          mean=[1, -3, 4],</span>
<span class="sd">        ...          cov=[[4, 2, -2],</span>
<span class="sd">        ...               [2, 5, -5],</span>
<span class="sd">        ...               [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; dis.precision_matrix</span>
<span class="sd">        array([[ 0.3125    , -0.125     ,  0.        ],</span>
<span class="sd">               [-0.125     ,  0.58333333,  0.33333333],</span>
<span class="sd">               [ 0.        ,  0.33333333,  0.33333333]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span>

<div class="viewcode-block" id="GaussianDistribution.marginalize"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.marginalize">[docs]</a>    <span class="k">def</span> <span class="nf">marginalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modifies the distribution with marginalized values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        variables: iterator over any hashable object.</span>
<span class="sd">                List of variables over which marginalization is to be done.</span>

<span class="sd">        inplace: boolean</span>
<span class="sd">                If inplace=True it will modify the distribution itself,</span>
<span class="sd">                else would return a new distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GaussianDistribution or None :</span>
<span class="sd">                if inplace=True (default) returns None</span>
<span class="sd">                if inplace=False return a new GaussianDistribution instance</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...          mean=[1, -3, 4],</span>
<span class="sd">        ...          cov=[[4, 2, -2],</span>
<span class="sd">        ...               [2, 5, -5],</span>
<span class="sd">        ...               [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; dis.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dis.mean</span>
<span class="sd">        array([[ 1],</span>
<span class="sd">               [-3],</span>
<span class="sd">               [ 4]])</span>
<span class="sd">        &gt;&gt;&gt; dis.covariance</span>
<span class="sd">        array([[ 4,  2, -2],</span>
<span class="sd">               [ 2,  5, -5],</span>
<span class="sd">               [-2, -5,  8]])</span>

<span class="sd">        &gt;&gt;&gt; dis.marginalize([&#39;x3&#39;])</span>
<span class="sd">        dis.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dis.mean</span>
<span class="sd">        array([[ 1.],</span>
<span class="sd">               [-3.]]))</span>
<span class="sd">        &gt;&gt;&gt; dis.covariance</span>
<span class="sd">        array([[4., 2.],</span>
<span class="sd">               [2., 5.]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;variables: Expected type list or array-like, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">variables</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">index_to_keep</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">variables</span>
        <span class="p">]</span>

        <span class="n">phi</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_to_keep</span><span class="p">]</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="n">index_to_keep</span><span class="p">]</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">index_to_keep</span><span class="p">,</span> <span class="n">index_to_keep</span><span class="p">)]</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span></div>

<div class="viewcode-block" id="GaussianDistribution.reduce"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.reduce">[docs]</a>    <span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduces the distribution to the context of the given variable values.</span>

<span class="sd">        The formula for the obtained conditional distribution is given by -</span>

<span class="sd">        For,</span>
<span class="sd">        .. math:: N(X_j | X_i = x_i) ~ N(mu_{j.i} ; sig_{j.i})</span>

<span class="sd">        where,</span>
<span class="sd">        .. math:: mu_{j.i} = mu_j + sig_{j, i} * {sig_{i, i}^{-1}} * (x_i - mu_i)</span>
<span class="sd">        .. math:: sig_{j.i} = sig_{j, j} - sig_{j, i} * {sig_{i, i}^{-1}} * sig_{i, j}</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values: list, array-like</span>
<span class="sd">            A list of tuples of the form (variable_name, variable_value).</span>

<span class="sd">        inplace: boolean</span>
<span class="sd">            If inplace=True it will modify the factor itself, else would return</span>
<span class="sd">            a new ContinuousFactor object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GaussianDistribution or None:</span>
<span class="sd">                if inplace=True (default) returns None</span>
<span class="sd">                if inplace=False returns a new GaussianDistribution instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...             mean=[1, -3, 4],</span>
<span class="sd">        ...             cov=[[4, 2, -2],</span>
<span class="sd">        ...                  [2, 5, -5],</span>
<span class="sd">        ...                  [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; dis.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dis.mean</span>
<span class="sd">        array([[ 1.],</span>
<span class="sd">               [-3.],</span>
<span class="sd">               [ 4.]])</span>
<span class="sd">        &gt;&gt;&gt; dis.covariance</span>
<span class="sd">        array([[ 4.,  2., -2.],</span>
<span class="sd">               [ 2.,  5., -5.],</span>
<span class="sd">               [-2., -5.,  8.]])</span>

<span class="sd">        &gt;&gt;&gt; dis.reduce([(&#39;x1&#39;, 7)])</span>
<span class="sd">        &gt;&gt;&gt; dis.variables</span>
<span class="sd">        [&#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; dis.mean</span>
<span class="sd">        array([[ 0.],</span>
<span class="sd">               [ 1.]])</span>
<span class="sd">        &gt;&gt;&gt; dis.covariance</span>
<span class="sd">        array([[ 4., -4.],</span>
<span class="sd">               [-4.,  7.]])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;values: Expected type list or array-like, got type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">var_to_reduce</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>

        <span class="c1"># index_to_keep -&gt; j vector</span>
        <span class="n">index_to_keep</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span>
            <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">var_to_reduce</span>
        <span class="p">]</span>
        <span class="c1"># index_to_reduce -&gt; i vector</span>
        <span class="n">index_to_reduce</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">var_to_reduce</span><span class="p">]</span>

        <span class="n">mu_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="n">index_to_keep</span><span class="p">]</span>
        <span class="n">mu_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="n">index_to_reduce</span><span class="p">]</span>
        <span class="n">x_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">value</span> <span class="k">for</span> <span class="n">var</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">index_to_reduce</span><span class="p">),</span> <span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">sig_i_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">index_to_reduce</span><span class="p">,</span> <span class="n">index_to_keep</span><span class="p">)]</span>
        <span class="n">sig_j_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">index_to_keep</span><span class="p">,</span> <span class="n">index_to_reduce</span><span class="p">)]</span>
        <span class="n">sig_i_i_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">index_to_reduce</span><span class="p">,</span> <span class="n">index_to_reduce</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">sig_j_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ix_</span><span class="p">(</span><span class="n">index_to_keep</span><span class="p">,</span> <span class="n">index_to_keep</span><span class="p">)]</span>

        <span class="n">phi</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">index_to_keep</span><span class="p">]</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mu_j</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">([</span><span class="n">sig_j_i</span><span class="p">,</span> <span class="n">sig_i_i_inv</span><span class="p">,</span> <span class="n">x_i</span> <span class="o">-</span> <span class="n">mu_i</span><span class="p">])</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">sig_j_j</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">multi_dot</span><span class="p">([</span><span class="n">sig_j_i</span><span class="p">,</span> <span class="n">sig_i_i_inv</span><span class="p">,</span> <span class="n">sig_i_j</span><span class="p">])</span>
        <span class="n">phi</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span></div>

<div class="viewcode-block" id="GaussianDistribution.normalize"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalizes the distribution. In case of a Gaussian Distribution the</span>
<span class="sd">        distribution is always normalized, therefore this method doesn&#39;t do</span>
<span class="sd">        anything and has been implemented only for a consistent API across</span>
<span class="sd">        distributions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">inplace</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># The pdf of a Joint Gaussian distrinution is always</span>
        <span class="c1"># normalized. Hence, no changes.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span></div>

<div class="viewcode-block" id="GaussianDistribution.copy"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the distribution.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        GaussianDistribution: copy of the distribution</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; gauss_dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...                mean=[1, -3, 4],</span>
<span class="sd">        ...                cov=[[4, 2, -2],</span>
<span class="sd">        ...                     [2, 5, -5],</span>
<span class="sd">        ...                     [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; copy_dis = gauss_dis.copy()</span>
<span class="sd">        &gt;&gt;&gt; copy_dis.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; copy_dis.mean</span>
<span class="sd">        array([[ 1],</span>
<span class="sd">                [-3],</span>
<span class="sd">                [ 4]])</span>
<span class="sd">        &gt;&gt;&gt; copy_dis.covariance</span>
<span class="sd">        array([[ 4,  2, -2],</span>
<span class="sd">                [ 2,  5, -5],</span>
<span class="sd">                [-2, -5,  8]])</span>
<span class="sd">        &gt;&gt;&gt; copy_dis.precision_matrix</span>
<span class="sd">        array([[ 0.3125    , -0.125     ,  0.        ],</span>
<span class="sd">                [-0.125     ,  0.58333333,  0.33333333],</span>
<span class="sd">                [ 0.        ,  0.33333333,  0.33333333]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">copy_distribution</span> <span class="o">=</span> <span class="n">GaussianDistribution</span><span class="p">(</span>
            <span class="n">variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">cov</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">copy_distribution</span><span class="o">.</span><span class="n">_precision_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precision_matrix</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">copy_distribution</span></div>

<div class="viewcode-block" id="GaussianDistribution.to_canonical_factor"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.to_canonical_factor">[docs]</a>    <span class="k">def</span> <span class="nf">to_canonical_factor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an equivalent CanonicalDistribution object.</span>

<span class="sd">        The formulas for calculating the canonical factor parameters</span>
<span class="sd">        for N(μ; Σ) = C(K; h; g) are as follows -</span>

<span class="sd">        K = sigma^(-1)</span>
<span class="sd">        h = sigma^(-1) * mu</span>
<span class="sd">        g = -(0.5) * mu.T * sigma^(-1) * mu -</span>
<span class="sd">            log((2*pi)^(n/2) * det(sigma)^(0.5))</span>

<span class="sd">        where,</span>
<span class="sd">        K,h,g are the canonical factor parameters</span>
<span class="sd">        sigma is the covariance_matrix of the distribution,</span>
<span class="sd">        mu is the mean_vector of the distribution,</span>
<span class="sd">        mu.T is the transpose of the matrix mu,</span>
<span class="sd">        and det(sigma) is the determinant of the matrix sigma.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis = GD(variables=[&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;],</span>
<span class="sd">        ...          mean=[1, -3, 4],</span>
<span class="sd">        ...          cov=[[4, 2, -2],</span>
<span class="sd">        ...               [2, 5, -5],</span>
<span class="sd">        ...               [-2, -5, 8]])</span>
<span class="sd">        &gt;&gt;&gt; phi = dis.to_canonical_factor()</span>
<span class="sd">        &gt;&gt;&gt; phi.variables</span>
<span class="sd">        [&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;]</span>
<span class="sd">        &gt;&gt;&gt; phi.K</span>
<span class="sd">        array([[0.3125, -0.125, 0.],</span>
<span class="sd">               [-0.125, 0.5833, 0.333],</span>
<span class="sd">               [     0., 0.333, 0.333]])</span>
<span class="sd">        &gt;&gt;&gt; phi.h</span>
<span class="sd">        array([[  0.6875],</span>
<span class="sd">               [-0.54166],</span>
<span class="sd">               [ 0.33333]]))</span>
<span class="sd">        &gt;&gt;&gt; phi.g</span>
<span class="sd">        -6.51533</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">coreBN.factors.continuous</span> <span class="kn">import</span> <span class="n">CanonicalDistribution</span>

        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span>

        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision_matrix</span>

        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mu</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">h</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">sigma</span><span class="p">)),</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">CanonicalDistribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_operate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gives the CanonicalDistribution operation (product or divide) with</span>
<span class="sd">        the other factor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: CanonicalDistribution</span>
<span class="sd">            The CanonicalDistribution to be multiplied.</span>

<span class="sd">        operation: String</span>
<span class="sd">            &#39;product&#39; for multiplication operation and</span>
<span class="sd">            &#39;divide&#39; for division operation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CanonicalDistribution or None:</span>
<span class="sd">                        if inplace=True (default) returns None</span>
<span class="sd">                        if inplace=False returns a new CanonicalDistribution instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis1 = GD([&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;], np.array([[1], [-3], [4]]),</span>
<span class="sd">        ...             np.array([[4, 2, -2], [2, 5, -5], [-2, -5, 8]]))</span>
<span class="sd">        &gt;&gt;&gt; dis2 = GD([&#39;x3&#39;, &#39;x4&#39;], [1, 2], [[2, 3], [5, 6]])</span>
<span class="sd">        &gt;&gt;&gt; dis3 = dis1 * dis2</span>
<span class="sd">        &gt;&gt;&gt; dis3.covariance</span>
<span class="sd">        array([[ 3.6,  1. , -0.4, -0.6],</span>
<span class="sd">               [ 1. ,  2.5, -1. , -1.5],</span>
<span class="sd">               [-0.4, -1. ,  1.6,  2.4],</span>
<span class="sd">               [-1. , -2.5,  4. ,  4.5]])</span>
<span class="sd">        &gt;&gt;&gt; dis3.mean</span>
<span class="sd">        array([[ 1.6],</span>
<span class="sd">               [-1.5],</span>
<span class="sd">               [ 1.6],</span>
<span class="sd">               [ 3.5]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_canonical_factor</span><span class="p">()</span>
            <span class="o">.</span><span class="n">_operate</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">to_canonical_factor</span><span class="p">(),</span> <span class="n">operation</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">to_joint_gaussian</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span>

<div class="viewcode-block" id="GaussianDistribution.product"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.product">[docs]</a>    <span class="k">def</span> <span class="nf">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TODO: Make it work when using `*` instead of product.</span>

<span class="sd">        Returns the product of two gaussian distributions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: GaussianDistribution</span>
<span class="sd">            The GaussianDistribution to be multiplied.</span>

<span class="sd">        inplace: boolean</span>
<span class="sd">            If True, modifies the distribution itself, otherwise returns a new</span>
<span class="sd">            GaussianDistribution object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CanonicalDistribution or None:</span>
<span class="sd">                    if inplace=True (default) returns None.</span>
<span class="sd">                    if inplace=False returns a new CanonicalDistribution instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis1 = GD([&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;], np.array([[1], [-3], [4]]),</span>
<span class="sd">        ...            np.array([[4, 2, -2], [2, 5, -5], [-2, -5, 8]]))</span>
<span class="sd">        &gt;&gt;&gt; dis2 = GD([&#39;x3&#39;, &#39;x4&#39;], [1, 2], [[2, 3], [5, 6]])</span>
<span class="sd">        &gt;&gt;&gt; dis3 = dis1.product(dis2, inplace=False)</span>
<span class="sd">        &gt;&gt;&gt; dis3.covariance</span>
<span class="sd">        array([[ 3.6,  1. , -0.4, -0.6],</span>
<span class="sd">               [ 1. ,  2.5, -1. , -1.5],</span>
<span class="sd">               [-0.4, -1. ,  1.6,  2.4],</span>
<span class="sd">               [-1. , -2.5,  4. ,  4.5]])</span>
<span class="sd">        &gt;&gt;&gt; dis3.mean</span>
<span class="sd">        array([[ 1.6],</span>
<span class="sd">               [-1.5],</span>
<span class="sd">               [ 1.6],</span>
<span class="sd">               [ 3.5]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operate</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;product&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

<div class="viewcode-block" id="GaussianDistribution.divide"><a class="viewcode-back" href="../../../../coreBN.factors.distributions.html#coreBN.factors.distributions.GaussianDistribution.GaussianDistribution.divide">[docs]</a>    <span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the division of two gaussian distributions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other: GaussianDistribution</span>
<span class="sd">            The GaussianDistribution to be divided.</span>

<span class="sd">        inplace: boolean</span>
<span class="sd">            If True, modifies the distribution itself, otherwise returns a new</span>
<span class="sd">            GaussianDistribution object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CanonicalDistribution or None:</span>
<span class="sd">                    if inplace=True (default) returns None.</span>
<span class="sd">                    if inplace=False returns a new CanonicalDistribution instance.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from coreBN.factors.distributions import GaussianDistribution as GD</span>
<span class="sd">        &gt;&gt;&gt; dis1 = GD([&#39;x1&#39;, &#39;x2&#39;, &#39;x3&#39;], np.array([[1], [-3], [4]]),</span>
<span class="sd">        ...            np.array([[4, 2, -2], [2, 5, -5], [-2, -5, 8]]))</span>
<span class="sd">        &gt;&gt;&gt; dis2 = GD([&#39;x3&#39;, &#39;x4&#39;], [1, 2], [[2, 3], [5, 6]])</span>
<span class="sd">        &gt;&gt;&gt; dis3 = dis1.divide(dis2, inplace=False)</span>
<span class="sd">        &gt;&gt;&gt; dis3.covariance</span>
<span class="sd">        array([[ 3.6,  1. , -0.4, -0.6],</span>
<span class="sd">               [ 1. ,  2.5, -1. , -1.5],</span>
<span class="sd">               [-0.4, -1. ,  1.6,  2.4],</span>
<span class="sd">               [-1. , -2.5,  4. ,  4.5]])</span>
<span class="sd">        &gt;&gt;&gt; dis3.mean</span>
<span class="sd">        array([[ 1.6],</span>
<span class="sd">               [-1.5],</span>
<span class="sd">               [ 1.6],</span>
<span class="sd">               [ 3.5]])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operate</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">operation</span><span class="o">=</span><span class="s2">&quot;divide&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;GaussianDistribution representing N(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="si">}</span><span class="s2">) at </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">__div__</span> <span class="o">=</span> <span class="fm">__truediv__</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GaussianDistribution</span><span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GaussianDistribution</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">scope</span><span class="p">()):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Computing transform_index to be able to easily have variables in same order.</span>
            <span class="n">transform_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">]</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">mean</span><span class="p">[</span><span class="n">transform_index</span><span class="p">]):</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mid_cov</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">covariance</span><span class="p">[</span><span class="n">transform_index</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">transform_cov</span> <span class="o">=</span> <span class="n">mid_cov</span><span class="p">[:,</span> <span class="n">transform_index</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">,</span> <span class="n">transform_cov</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Serafina Di Gioia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>