<!DOCTYPE html>
<html class="writer-html5" lang="English/Python">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coreBN.estimators package &mdash; gABi 00.00.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="coreBN.extern package" href="coreBN.extern.html" />
    <link rel="prev" title="coreBN.base package" href="coreBN.base.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            gABi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">coreBN</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="coreBN.html">coreBN package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="coreBN.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="coreBN.CItests.html">coreBN.CItests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.IO.html">coreBN.IO package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.base.html">coreBN.base package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">coreBN.estimators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.extern.html">coreBN.extern package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.factors.html">coreBN.factors package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.independencies.html">coreBN.independencies package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.inference.html">coreBN.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.metrics.html">coreBN.metrics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.models.html">coreBN.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.sampling.html">coreBN.sampling package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.tests.html">coreBN.tests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.utils.html">coreBN.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN.global_vars">coreBN.global_vars module</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gABi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">coreBN</a></li>
          <li class="breadcrumb-item"><a href="coreBN.html">coreBN package</a></li>
      <li class="breadcrumb-item active">coreBN.estimators package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/coreBN.estimators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="corebn-estimators-package">
<h1>coreBN.estimators package<a class="headerlink" href="#corebn-estimators-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-coreBN.estimators.BayesianEstimator">
<span id="corebn-estimators-bayesianestimator-module"></span><h2>coreBN.estimators.BayesianEstimator module<a class="headerlink" href="#module-coreBN.estimators.BayesianEstimator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator.BayesianEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.BayesianEstimator.</span></span><span class="sig-name descname"><span class="pre">BayesianEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator.BayesianEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator.BayesianEstimator.estimate_cpd">
<span class="sig-name descname"><span class="pre">estimate_cpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BDeu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator.estimate_cpd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator.BayesianEstimator.estimate_cpd" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the CPD for a given variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>int</em><em>, </em><em>string</em><em> (</em><em>any hashable python object</em><em>)</em>) -- The name of the variable for which the CPD is to be estimated.</p></li>
<li><p><strong>prior_type</strong> (<em>'dirichlet'</em><em>, </em><em>'BDeu'</em><em>, </em><em>'K2'</em><em>,</em>) -- <p>string indicting which type of prior to use for the model parameters.
- If 'prior_type' is 'dirichlet', the following must be provided:</p>
<blockquote>
<div><dl class="simple">
<dt>'pseudo_counts' = dirichlet hyperparameters; a single number or 2-D array</dt><dd><p>of shape (node_card, product of parents_card) with a &quot;virtual&quot; count for
each variable state in the CPD. The virtual counts are added to the
actual state counts found in the data. (if a list is provided, a
lexicographic ordering of states is assumed)</p>
</dd>
</dl>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>If 'prior_type' is 'BDeu', then an 'equivalent_sample_size'</dt><dd><p>must be specified instead of 'pseudo_counts'. This is equivalent to
'prior_type=dirichlet' and using uniform 'pseudo_counts' of
<cite>equivalent_sample_size/(node_cardinality*np.prod(parents_cardinalities))</cite>.</p>
</dd>
</dl>
</li>
<li><p>A prior_type of 'K2' is a shorthand for 'dirichlet' + setting every
pseudo_count to 1, regardless of the cardinality of the variable.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CPD</strong> -- The estimated CPD for <cite>node</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.CPD.TabularCPD" title="coreBN.factors.discrete.CPD.TabularCPD">TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_C</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;dirichlet&quot;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">pseudo_counts</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                                              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cpd_C</span><span class="p">)</span>
<span class="go">╒══════╤══════╤══════╤══════╤════════════════════╕</span>
<span class="go">│ A    │ A(0) │ A(0) │ A(1) │ A(1)               │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ B    │ B(0) │ B(1) │ B(0) │ B(1)               │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ C(0) │ 0.25 │ 0.25 │ 0.5  │ 0.3333333333333333 │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ C(1) │ 0.75 │ 0.75 │ 0.5  │ 0.6666666666666666 │</span>
<span class="go">╘══════╧══════╧══════╧══════╧════════════════════╛</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator.BayesianEstimator.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BDeu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator.BayesianEstimator.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the model parameters (CPDs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prior_type</strong> (<em>'dirichlet'</em><em>, </em><em>'BDeu'</em><em>, or </em><em>'K2'</em>) -- <p>string indicting which type of prior to use for the model parameters.
- If 'prior_type' is 'dirichlet', the following must be provided:</p>
<blockquote>
<div><dl class="simple">
<dt>'pseudo_counts' = dirichlet hyperparameters; a single number or a dict containing, for each</dt><dd><p>variable, a 2-D array of the shape (node_card, product of parents_card) with a &quot;virtual&quot;
count for each variable state in the CPD, that is added to the state counts.
(lexicographic ordering of states assumed)</p>
</dd>
</dl>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>If 'prior_type' is 'BDeu', then an 'equivalent_sample_size'</dt><dd><p>must be specified instead of 'pseudo_counts'. This is equivalent to
'prior_type=dirichlet' and using uniform 'pseudo_counts' of
<cite>equivalent_sample_size/(node_cardinality*np.prod(parents_cardinalities))</cite> for each node.
'equivalent_sample_size' can either be a numerical value or a dict that specifies
the size for each variable separately.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A prior_type of 'K2' is a shorthand for 'dirichlet' + setting every pseudo_count to 1,</dt><dd><p>regardless of the cardinality of the variable.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>parameters</strong> -- List of TabularCPDs, one for each variable of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">prior_type</span><span class="o">=</span><span class="s1">&#39;BDeu&#39;</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[&lt;TabularCPD representing P(C:2) at 0x7f7b534251d0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(B:2 | C:2, A:2) at 0x7f7b4dfd4da0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(A:2) at 0x7f7b4dfd4fd0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(D:2 | C:2) at 0x7f7b4df822b0&gt;]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.EM">
<span id="corebn-estimators-em-module"></span><h2>coreBN.estimators.EM module<a class="headerlink" href="#module-coreBN.estimators.EM" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.EM.ExpectationMaximization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.EM.</span></span><span class="sig-name descname"><span class="pre">ExpectationMaximization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/EM.html#ExpectationMaximization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.EM.ExpectationMaximization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.EM.ExpectationMaximization.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latent_card</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/EM.html#ExpectationMaximization.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.EM.ExpectationMaximization.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate all model parameters (CPDs) using Expecation Maximization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latent_card</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- A dictionary of the form {latent_var: cardinality} specifying the
cardinality (number of states) of each latent variable. If None,
assumes <cite>2</cite> states for each latent variable.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em> (</em><em>default: 100</em><em>)</em>) -- The maximum number of iterations the algorithm is allowed to run for.
If max_iter is reached, return the last value of parameters.</p></li>
<li><p><strong>atol</strong> (<em>int</em><em> (</em><em>default: 1e-08</em><em>)</em>) -- The absolute accepted tolerance for checking convergence. If the parameters
change is less than atol in an iteration, the algorithm will exit.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em> (</em><em>default: -1</em><em>)</em>) -- Number of jobs to run in parallel. Default: -1 uses all the processors.
Suggest to use n_jobs=1 when dataset size is less than 1000.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em> (</em><em>default: 1000</em><em>)</em>) -- Number of data used to compute weights in a batch.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) -- The random seed to use for generating the intial values.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- Whether to show a progress bar for iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated paramters (CPDs)</strong> -- A list of estimated CPDs for the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">ExpectationMaximization</span> <span class="k">as</span> <span class="n">EM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)],</span> <span class="n">latents</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;B&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">EM</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.Estimator">
<span id="corebn-estimators-estimator-module"></span><h2>coreBN.estimators.Estimator module<a class="headerlink" href="#module-coreBN.estimators.Estimator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.BaseEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.Estimator.</span></span><span class="sig-name descname"><span class="pre">BaseEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_samples_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#BaseEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.Estimator.BaseEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.BaseEstimator.state_counts">
<span class="sig-name descname"><span class="pre">state_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_samples_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coreBN.estimators.Estimator.BaseEstimator.state_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.ParameterEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.Estimator.</span></span><span class="sig-name descname"><span class="pre">ParameterEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#ParameterEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.Estimator.ParameterEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.ParameterEstimator.state_counts">
<span class="sig-name descname"><span class="pre">state_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#ParameterEstimator.state_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.Estimator.ParameterEstimator.state_counts" title="Permalink to this definition"></a></dt>
<dd><p>Return counts how often each state of 'variable' occurred in the data.
If the variable has parents, counting is done conditionally
for each state configuration of the parents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable</strong> (<em>string</em>) -- Name of the variable for which the state count is to be done.</p></li>
<li><p><strong>complete_samples_only</strong> (<em>bool</em>) -- Specifies how to deal with missing data, if present. If set to <cite>True</cite> all rows
that contain <cite>np.NaN</cite> somewhere are ignored. If <cite>False</cite> then
every row where neither the variable nor its parents are <cite>np.NaN</cite> is used.
Desired default behavior can be passed to the class constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state_counts</strong> -- Table with state counts for 'variable'</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">ParameterEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
<span class="go">                              &#39;B&#39;: [&#39;b1&#39;, &#39;b2&#39;, &#39;b1&#39;],</span>
<span class="go">                              &#39;C&#39;: [&#39;c1&#39;, &#39;c1&#39;, &#39;c2&#39;]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">    A</span>
<span class="go">a1  2</span>
<span class="go">a2  1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="go">A  a1      a2</span>
<span class="go">B  b1  b2  b1  b2</span>
<span class="go">C</span>
<span class="go">c1  1   1   0   0</span>
<span class="go">c2  0   0   1   0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.StructureEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.Estimator.</span></span><span class="sig-name descname"><span class="pre">StructureEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#StructureEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.Estimator.StructureEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.Estimator.StructureEstimator.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#StructureEstimator.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.Estimator.StructureEstimator.estimate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.HillClimbSearch">
<span id="corebn-estimators-hillclimbsearch-module"></span><h2>coreBN.estimators.HillClimbSearch module<a class="headerlink" href="#module-coreBN.estimators.HillClimbSearch" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.HillClimbSearch.HillClimbSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.HillClimbSearch.</span></span><span class="sig-name descname"><span class="pre">HillClimbSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/HillClimbSearch.html#HillClimbSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.HillClimbSearch.HillClimbSearch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.HillClimbSearch.HillClimbSearch.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scoring_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k2score'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_dag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabu_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_indegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">black_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/HillClimbSearch.html#HillClimbSearch.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.HillClimbSearch.HillClimbSearch.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Performs local hill climb search to estimates the <cite>DAG</cite> structure that
has optimal score, according to the scoring method supplied. Starts at
model <cite>start_dag</cite> and proceeds by step-by-step network modifications
until a local maximum is reached. Only estimates network structure, no
parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scoring_method</strong> (<em>str</em><em> or </em><em>StructureScore instance</em>) -- The score to be optimized during structure estimation.  Supported
structure scores: k2score, bdeuscore, bdsscore, bicscore. Also accepts a
custom score but it should be an instance of <cite>StructureScore</cite>.</p></li>
<li><p><strong>start_dag</strong> (<em>DAG instance</em>) -- The starting point for the local search. By default a completely
disconnected network is used.</p></li>
<li><p><strong>fixed_edges</strong> (<em>iterable</em>) -- A list of edges that will always be there in the final learned model.
The algorithm will add these edges at the start of the algorithm and
will never change it.</p></li>
<li><p><strong>tabu_length</strong> (<em>int</em>) -- If provided, the last <cite>tabu_length</cite> graph modifications cannot be reversed
during the search procedure. This serves to enforce a wider exploration
of the search space. Default value: 100.</p></li>
<li><p><strong>max_indegree</strong> (<em>int</em><em> or </em><em>None</em>) -- If provided and unequal None, the procedure only searches among models
where all nodes have at most <cite>max_indegree</cite> parents. Defaults to None.</p></li>
<li><p><strong>black_list</strong> (<em>list</em><em> or </em><em>None</em>) -- If a list of edges is provided as <cite>black_list</cite>, they are excluded from the search
and the resulting model will not contain any of those edges. Default: None</p></li>
<li><p><strong>white_list</strong> (<em>list</em><em> or </em><em>None</em>) -- If a list of edges is provided as <cite>white_list</cite>, the search is limited to those
edges. The resulting model will then only contain edges that are in <cite>white_list</cite>.
Default: None</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em> (</em><em>default: 1e-4</em><em>)</em>) -- Defines the exit condition. If the improvement in score is less than <cite>epsilon</cite>,
the learned model is returned.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em> (</em><em>default: 1e6</em><em>)</em>) -- The maximum number of iterations allowed. Returns the learned model when the
number of iterations is greater than <cite>max_iter</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated model</strong> -- A <cite>DAG</cite> at a (local) score maximum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">HillClimbSearch</span><span class="p">,</span> <span class="n">BicScore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create data sample with 9 random variables:</span>
<span class="gp">... </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGHI&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add 10th dependent variable</span>
<span class="gp">... </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">est</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">OutEdgeView([(&#39;B&#39;, &#39;J&#39;), (&#39;A&#39;, &#39;J&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># search a model with restriction on the number of parents:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">max_indegree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">OutEdgeView([(&#39;J&#39;, &#39;A&#39;), (&#39;B&#39;, &#39;J&#39;)])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.LinearModel">
<span id="corebn-estimators-linearmodel-module"></span><h2>coreBN.estimators.LinearModel module<a class="headerlink" href="#module-coreBN.estimators.LinearModel" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.LinearModel.LinearEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.LinearModel.</span></span><span class="sig-name descname"><span class="pre">LinearEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/LinearModel.html#LinearEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.LinearModel.LinearEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A simple linear model built on statmodels.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.LinearModel.LinearEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/LinearModel.html#LinearEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.LinearModel.LinearEstimator.fit" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.LinearModel.LinearEstimator.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/LinearModel.html#LinearEstimator.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.LinearModel.LinearEstimator.summary" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.MLE">
<span id="corebn-estimators-mle-module"></span><h2>coreBN.estimators.MLE module<a class="headerlink" href="#module-coreBN.estimators.MLE" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.MLE.MaximumLikelihoodEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.MLE.</span></span><span class="sig-name descname"><span class="pre">MaximumLikelihoodEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MLE.MaximumLikelihoodEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.MLE.MaximumLikelihoodEstimator.estimate_cpd">
<span class="sig-name descname"><span class="pre">estimate_cpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator.estimate_cpd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MLE.MaximumLikelihoodEstimator.estimate_cpd" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the CPD for a given variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>int</em><em>, </em><em>string</em><em> (</em><em>any hashable python object</em><em>)</em>) -- The name of the variable for which the CPD is to be estimated.</p></li>
<li><p><strong>weighted</strong> (<em>bool</em>) -- If weighted=True, the data must contain a <cite>_weight</cite> column specifying the
weight of each datapoint (row). If False, assigns an equal weight to each
datapoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated CPD</strong> -- Estimated CPD for <cite>node</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.TabularCPD" title="coreBN.factors.discrete.TabularCPD">coreBN.factors.discrete.TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_A</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cpd_A</span><span class="p">)</span>
<span class="go">╒══════╤══════════╕</span>
<span class="go">│ A(0) │ 0.666667 │</span>
<span class="go">├──────┼──────────┤</span>
<span class="go">│ A(1) │ 0.333333 │</span>
<span class="go">╘══════╧══════════╛</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.MLE.MaximumLikelihoodEstimator.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MLE.MaximumLikelihoodEstimator.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the model parameters (CPDs) using Maximum Likelihood
Estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_jobs</strong> (<em>int</em><em> (</em><em>default: -1</em><em>)</em>) -- Number of jobs to run in parallel. Default: -1 uses all the processors.</p></li>
<li><p><strong>weighted</strong> (<em>bool</em>) -- If weighted=True, the data must contain a <cite>_weight</cite> column specifying the
weight of each datapoint (row). If False, assigns an equal weight to each
datapoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated parameters</strong> -- List of coreBN.factors.discrete.TabularCPDs, one for each variable of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
<span class="go">[&lt;TabularCPD representing P(C:2) at 0x7f7b534251d0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(B:2 | C:2, A:2) at 0x7f7b4dfd4da0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(A:2) at 0x7f7b4dfd4fd0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(D:2 | C:2) at 0x7f7b4df822b0&gt;]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.PC">
<span id="corebn-estimators-pc-module"></span><h2>coreBN.estimators.PC module<a class="headerlink" href="#module-coreBN.estimators.PC" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.PC.PC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.PC.</span></span><span class="sig-name descname"><span class="pre">PC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.PC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.PC.build_skeleton">
<span class="sig-name descname"><span class="pre">build_skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.build_skeleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.PC.build_skeleton" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a graph skeleton (UndirectedGraph) from a set of independencies
using (the first part of) the PC algorithm. The independencies can either be
provided as an instance of the <cite>Independencies</cite>-class or by passing a
decision function that decides any conditional independency assertion.
Returns a tuple <cite>(skeleton, separating_sets)</cite>.</p>
<p>If an Independencies-instance is passed, the contained IndependenceAssertions
have to admit a faithful BN representation. This is the case if
they are obtained as a set of d-seperations of some Bayesian network or
if the independence assertions are closed under the semi-graphoid axioms.
Otherwise the procedure may fail to identify the correct structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>skeleton</strong> (<em>UndirectedGraph</em>) -- An estimate for the undirected graph skeleton of the BN underlying the data.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation procedures)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)</dt><dd><p><a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
</dd>
<dt>[2] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</dt><dd><p>Section 3.4.2.1 (page 85), Algorithm 3.3</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.base</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.independencies</span> <span class="kn">import</span> <span class="n">Independencies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from list of independencies:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">Independencies</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we need to compute closure, otherwise this set of independencies doesn&#39;t</span>
<span class="gp">... </span><span class="c1"># admit a faithful representation:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="o">.</span><span class="n">closure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">independencies</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="s2">&quot;ABCD&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;D&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;D&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from d-seperations of DAG:</span>
<span class="gp">... </span><span class="n">model</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;E&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.PC.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iclient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.PC.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a DAG/PDAG from the given dataset using the PC algorithm which
is a constraint-based structure learning algorithm[1]. The independencies
in the dataset are identified by doing statistical independece test. This
method returns a DAG/PDAG structure which is faithful to the independencies
implied by the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<em>str</em><em> (</em><em>one</em><em> of </em><em>&quot;orig&quot;</em><em>, </em><em>&quot;stable&quot;</em><em>, </em><em>&quot;parallel&quot;</em><em>)</em>) -- <p>The variant of PC algorithm to run.
&quot;orig&quot;: The original PC algorithm. Might not give the same</p>
<blockquote>
<div><p>results in different runs but does less independence
tests compared to stable.</p>
</div></blockquote>
<dl class="simple">
<dt>&quot;stable&quot;: Gives the same result in every run but does needs to</dt><dd><p>do more statistical independence tests.</p>
</dd>
<dt>&quot;parallel&quot;: Parallel version of PC Stable. Can run on multiple</dt><dd><p>cores with the same result on each run.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ci_test</strong> (<em>str</em><em> or </em><em>fun</em>) -- <p>The statistical test to use for testing conditional independence in
the dataset. If <cite>str</cite> values should be one of:</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;independence_match&quot;: If using this option, an additional parameter</dt><dd><p><cite>independencies</cite> must be specified.</p>
</dd>
<dt>&quot;chi_square&quot;: Uses the Chi-Square independence test. This works</dt><dd><p>only for discrete datasets.</p>
</dd>
<dt>&quot;pearsonr&quot;: Uses the pertial correlation based on pearson</dt><dd><p>correlation coefficient to test independence. This works
only for continuous datasets.</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>max_cond_vars</strong> (<em>int</em>) -- The maximum number of conditional variables allowed to do the statistical
test with.</p></li>
<li><p><strong>return_type</strong> (<em>str</em><em> (</em><em>one</em><em> of </em><em>&quot;dag&quot;</em><em>, </em><em>&quot;cpdag&quot;</em><em>, </em><em>&quot;pdag&quot;</em><em>, </em><em>&quot;skeleton&quot;</em><em>)</em>) -- <p>The type of structure to return.</p>
<p>If <cite>return_type=pdag</cite> or <cite>return_type=cpdag</cite>: a partially directed structure is returned.
If <cite>return_type=dag</cite>, a fully directed structure is returned if it</p>
<blockquote>
<div><p>is possible to orient all the edges.</p>
</div></blockquote>
<dl class="simple">
<dt>If <a href="#id1"><span class="problematic" id="id2">`</span></a>return_type=&quot;skeleton&quot;, returns an undirected graph along</dt><dd><p>with the separating sets.It is the output of the step 1 of the algorithm.</p>
</dd>
</dl>
</p></li>
<li><p><strong>significance_level</strong> (<em>float</em><em> (</em><em>default: 0.01</em><em>)</em>) -- <p>The statistical tests use this value to compare with the p-value of
the test to decide whether the tested variables are independent or
not. Different tests can treat this parameter differently:</p>
<blockquote>
<div><ol class="arabic simple">
<li><dl class="simple">
<dt>Chi-Square: If p-value &gt; significance_level, it assumes that the</dt><dd><p>independence condition satisfied in the data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pearsonr: If p-value &gt; significance_level, it assumes that the</dt><dd><p>independence condition satisfied in the data.</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated model</strong> -- The estimated model structure, can be a partially directed graph (PDAG)
or a fully directed graph (DAG), or (Undirected Graph, separating sets)
depending on the value of <cite>return_type</cite> argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a>, <a class="reference internal" href="coreBN.base.html#coreBN.base.PDAG" title="coreBN.base.PDAG">coreBN.base.PDAG</a>, or tuple(networkx.UndirectedGraph, dict)</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Original PC: P. Spirtes, C. Glymour, and R. Scheines, Causation,</dt><dd><p>Prediction, and Search, 2nd ed. Cambridge, MA: MIT Press, 2000.</p>
</dd>
<dt>[2] Stable PC:  D. Colombo and M. H. Maathuis, “A modification of the PC algorithm</dt><dd><p>yielding order-independent skeletons,” ArXiv e-prints, Nov. 2012.</p>
</dd>
<dt>[3] Parallel PC: Le, Thuc, et al. &quot;A fast PC algorithm for high dimensional causal</dt><dd><p>discovery with multi-core PCs.&quot; IEEE/ACM transactions on computational
biology and bioinformatics (2016).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;XYZ&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">      X  Y  Z  sum</span>
<span class="go">0     3  0  1    4</span>
<span class="go">1     1  4  3    8</span>
<span class="go">2     0  0  3    3</span>
<span class="go">3     0  2  3    5</span>
<span class="go">4     2  1  1    4</span>
<span class="gp">... </span> <span class="o">..</span> <span class="o">..</span> <span class="o">..</span>  <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;Z&#39;, &#39;sum&#39;), (&#39;X&#39;, &#39;sum&#39;), (&#39;Y&#39;, &#39;sum&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.PC.skeleton_to_pdag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">skeleton_to_pdag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separating_sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.skeleton_to_pdag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.PC.skeleton_to_pdag" title="Permalink to this definition"></a></dt>
<dd><p>Orients the edges of a graph skeleton based on information from
<cite>separating_sets</cite> to form a DAG pattern (DAG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.UndirectedGraph" title="coreBN.base.UndirectedGraph"><em>UndirectedGraph</em></a>) -- An undirected graph skeleton as e.g. produced by the
estimate_skeleton method.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model after edge orientation</strong> -- An estimate for the DAG pattern of the BN underlying the data. The
graph might contain some nodes with both-way edges (X-&gt;Y and Y-&gt;X).
Any completion by (removing one of the both-way edges for each such
pair) results in a I-equivalent Bayesian network DAG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)
<a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABD&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="c1"># edges: A-&gt;C, B-&gt;C, A--D (not directed)</span>
<span class="go">[(&#39;B&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;A&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="corebn-estimators-pc-old-module">
<h2>coreBN.estimators.PC-old module<a class="headerlink" href="#corebn-estimators-pc-old-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-coreBN.estimators.SEMEstimator">
<span id="corebn-estimators-semestimator-module"></span><h2>coreBN.estimators.SEMEstimator module<a class="headerlink" href="#module-coreBN.estimators.SEMEstimator" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.IVEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.SEMEstimator.</span></span><span class="sig-name descname"><span class="pre">IVEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#IVEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.IVEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements Instrumental Variable (IV) based estimator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.IVEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ivs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#IVEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.IVEstimator.fit" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the parameter X -&gt; Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- The covariate variable of the parameter being estimated.</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- The predictor variable of the parameter being estimated.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) -- The data from which to learn the parameter.</p></li>
<li><p><strong>ivs</strong> (<em>List</em><em> (</em><em>default: None</em><em>)</em>) -- List of variable names which should be used as Instrumental Variables (IV).
If not specified, tries to find the IVs from the model structure, fails if
can't find either IV or Conditional IV.</p></li>
<li><p><strong>civs</strong> (<em>List</em><em> of </em><em>tuples</em><em> (</em><em>tuple form:</em><em> (</em><em>var</em><em>, </em><em>coditional_var</em><em>)</em><em>)</em>) -- List of conditional IVs to use for estimation.
If not specified, tries to find the IVs from the model structure, fails if
can't find either IV or Conditional IVs.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">IVEstimator</span> <span class="c1"># TODO: Finish example.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.SEMEstimator.</span></span><span class="sig-name descname"><span class="pre">SEMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class of SEM estimators. All the estimators inherit this class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exit_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator.fit" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the parameters of the model from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas DataFrame</em><em> or </em><em>coreBN.data.Data instance</em>) -- The data from which to estimate the parameters of the model.</p></li>
<li><p><strong>method</strong> (<em>str</em><em> (</em><em>&quot;ml&quot;</em><em>|</em><em>&quot;uls&quot;</em><em>|</em><em>&quot;gls&quot;</em><em>|</em><em>&quot;2sls&quot;</em><em>)</em>) -- The fitting function to use.
ML : Maximum Likelihood
ULS: Unweighted Least Squares
GLS: Generalized Least Squares
2sls: 2-SLS estimator</p></li>
<li><p><strong>init_values</strong> (<em>str</em><em> or </em><em>dict</em>) -- Options for str: random | std | iv
dict: dictionary with keys <cite>B</cite> and <cite>zeta</cite>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) -- <p>Extra parameters required in case of some estimators.
GLS:</p>
<blockquote>
<div><p>W: np.array (n x n) where n is the number of observe variables.</p>
</div></blockquote>
<dl class="simple">
<dt>2sls:</dt><dd><p>x:
y:</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coreBN.model.SEM instance</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Instance of the model with estimated parameters</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Bollen, K. A. (2010). Structural equations with latent variables. New York: Wiley.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator.get_init_values">
<span class="sig-name descname"><span class="pre">get_init_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.get_init_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator.get_init_values" title="Permalink to this definition"></a></dt>
<dd><p>Computes the starting values for the optimizer.</p>
<section id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>Bollen, K. (2014). Structural Equations with Latent Variables.</dt><dd><p>New York, NY: John Wiley &amp; Sons.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator.gls_loss">
<span class="sig-name descname"><span class="pre">gls_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.gls_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator.gls_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Weighted Least Squares fitting function. The optimizer calls
this method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ULS} = tr { [(S - Sigma(theta)) W^{-1}]^2 }</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator.ml_loss">
<span class="sig-name descname"><span class="pre">ml_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.ml_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator.ml_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Maximum Likelihood loss function. The optimizer calls this
method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ML} = log <a href="#id10"><span class="problematic" id="id11">|\Sigma(\theta)|</span></a> + tr(S Sigma^{-1}(theta)) - log S - (p+q)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.SEMEstimator.uls_loss">
<span class="sig-name descname"><span class="pre">uls_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.uls_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.SEMEstimator.uls_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Unweighted Least Squares fitting function. The optimizer calls
this method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ULS} = tr[(S - Sigma(theta))^2]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.ScoreCache">
<span id="corebn-estimators-scorecache-module"></span><h2>coreBN.estimators.ScoreCache module<a class="headerlink" href="#module-coreBN.estimators.ScoreCache" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.ScoreCache.LRUCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.ScoreCache.</span></span><span class="sig-name descname"><span class="pre">LRUCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/ScoreCache.html#LRUCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ScoreCache.LRUCache" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.ScoreCache.ScoreCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.ScoreCache.</span></span><span class="sig-name descname"><span class="pre">ScoreCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_scorer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/ScoreCache.html#ScoreCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ScoreCache.ScoreCache" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.ScoreCache.ScoreCache.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/ScoreCache.html#ScoreCache.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ScoreCache.ScoreCache.local_score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators.StructureScore">
<span id="corebn-estimators-structurescore-module"></span><h2>coreBN.estimators.StructureScore module<a class="headerlink" href="#module-coreBN.estimators.StructureScore" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDeuScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.StructureScore.</span></span><span class="sig-name descname"><span class="pre">BDeuScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDeuScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDeuScore.get_number_of_parent_states">
<span class="sig-name descname"><span class="pre">get_number_of_parent_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_counts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore.get_number_of_parent_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDeuScore.get_number_of_parent_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDeuScore.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDeuScore.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDsScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.StructureScore.</span></span><span class="sig-name descname"><span class="pre">BDsScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDsScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.BDeuScore" title="coreBN.estimators.StructureScore.BDeuScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">BDeuScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDsScore.get_number_of_parent_states">
<span class="sig-name descname"><span class="pre">get_number_of_parent_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_counts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.get_number_of_parent_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDsScore.get_number_of_parent_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDsScore.structure_prior">
<span class="sig-name descname"><span class="pre">structure_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.structure_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDsScore.structure_prior" title="Permalink to this definition"></a></dt>
<dd><p>Implements the marginal uniform prior for the graph structure where each arc
is independent with the probability of an arc for any two nodes in either direction
is 1/4 and the probability of no arc between any two nodes is 1/2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BDsScore.structure_prior_ratio">
<span class="sig-name descname"><span class="pre">structure_prior_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.structure_prior_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BDsScore.structure_prior_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Return the log ratio of the prior probabilities for a given proposed change to
the DAG.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BicScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.StructureScore.</span></span><span class="sig-name descname"><span class="pre">BicScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BicScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BicScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.BicScore.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BicScore.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.BicScore.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.K2Score">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.StructureScore.</span></span><span class="sig-name descname"><span class="pre">K2Score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#K2Score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.K2Score" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.K2Score.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#K2Score.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.K2Score.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.StructureScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.StructureScore.</span></span><span class="sig-name descname"><span class="pre">StructureScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.StructureScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.StructureScore.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.StructureScore.score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score to measure how well the given <cite>BayesianNetwork</cite> fits
to the data set.  (This method relies on the <cite>local_score</cite>-method that
is implemented in each subclass.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>BayesianNetwork instance</em>) -- The Bayesian network that is to be scored. Nodes of the BayesianNetwork need to coincide
with column names of data set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> -- A number indicating the degree of fit between data and model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">K2Score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create random data sample with 3 variables, where B and C are identical:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">BayesianNetwork</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]]))</span>
<span class="go">-24242.367348745247</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">BayesianNetwork</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]]))</span>
<span class="go">-16273.793897051042</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.StructureScore.structure_prior">
<span class="sig-name descname"><span class="pre">structure_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.structure_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.StructureScore.structure_prior" title="Permalink to this definition"></a></dt>
<dd><p>A (log) prior distribution over models. Currently unused (= uniform).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.StructureScore.structure_prior_ratio">
<span class="sig-name descname"><span class="pre">structure_prior_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.structure_prior_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.StructureScore.structure_prior_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Return the log ratio of the prior probabilities for a given proposed change to the DAG.
Currently unused (=uniform).</p>
</dd></dl>

</dd></dl>

</section>
<section id="corebn-estimators-base-module">
<h2>coreBN.estimators.base module<a class="headerlink" href="#corebn-estimators-base-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-coreBN.estimators.kPC">
<span id="corebn-estimators-kpc-module"></span><h2>coreBN.estimators.kPC module<a class="headerlink" href="#module-coreBN.estimators.kPC" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.kPC.</span></span><span class="sig-name descname"><span class="pre">kPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC.PDAG_by_Meek_rules">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PDAG_by_Meek_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.PDAG_by_Meek_rules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC.PDAG_by_Meek_rules" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC.build_skeleton">
<span class="sig-name descname"><span class="pre">build_skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsic_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dask_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.build_skeleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC.build_skeleton" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a graph skeleton (UndirectedGraph) from a set of independencies
using (the first part of) the PC algorithm. The independencies can either be
provided as an instance of the <cite>Independencies</cite>-class or by passing a
decision function that decides any conditional independency assertion.
Returns a tuple <cite>(skeleton, separating_sets)</cite>.</p>
<p>If an Independencies-instance is passed, the contained IndependenceAssertions
have to admit a faithful BN representation. This is the case if
they are obtained as a set of d-seperations of some Bayesian network or
if the independence assertions are closed under the semi-graphoid axioms.
Otherwise the procedure may fail to identify the correct structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>skeleton</strong> (<em>UndirectedGraph</em>) -- An estimate for the undirected graph skeleton of the BN underlying the data.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation procedures)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)</dt><dd><p><a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
</dd>
<dt>[2] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</dt><dd><p>Section 3.4.2.1 (page 85), Algorithm 3.3</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.base</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.independencies</span> <span class="kn">import</span> <span class="n">Independencies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from list of independencies:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">Independencies</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we need to compute closure, otherwise this set of independencies doesn&#39;t</span>
<span class="gp">... </span><span class="c1"># admit a faithful representation:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="o">.</span><span class="n">closure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">independencies</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="s2">&quot;ABCD&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;D&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;D&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from d-seperations of DAG:</span>
<span class="gp">... </span><span class="n">model</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;E&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dcc_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dask_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a DAG/PDAG from the given dataset using the kernel PC algorithm which
is a generalization of the PC algorithm, the most common constraint-based structure learning algorithm[1].
The conditional independencies among the variables in the dataset are identified by doing statistical independece test.
This method returns a DAG/PDAG structure which is faithful to the independencies
implied by the dataset.</p>
<p>It can be applied to continuous vars with priors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<em>str</em><em> (</em><em>&quot;stable&quot;</em><em>, </em><em>&quot;parallel&quot;</em><em>)</em>) -- <p>The variant of PC algorithm to run.
&quot;orig&quot;: The original PC algorithm. Might not give the same</p>
<blockquote>
<div><p>results in different runs but does less independence
tests compared to stable.</p>
</div></blockquote>
<dl class="simple">
<dt>&quot;stable&quot;: Gives the same result in every run but does needs to</dt><dd><p>do more statistical independence tests.</p>
</dd>
<dt>&quot;parallel&quot;: Parallel version of PC Stable. Can run on multiple</dt><dd><p>cores with the same result on each run.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ci_test</strong> (<em>str</em><em> or </em><em>fun</em>) -- The statistical tests to use for testing conditional independence in
the dataset of continuous non gaussian vars are:
-&quot;HSIC-GAMMA&quot;
-&quot;HSIC-PERM&quot;
-&quot;DCOV-GAMMA&quot;
-&quot;DCOV-PERM&quot;</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>return_type: str (one of &quot;dag&quot;, &quot;cpdag&quot;, &quot;pdag&quot;, &quot;skeleton&quot;)</dt><dd><p>The type of structure to return.</p>
<p>If <cite>return_type=pdag</cite> or <cite>return_type=cpdag</cite>: a partially directed structure is returned.
If <cite>return_type=dag</cite>, a fully directed structure is returned if it</p>
<blockquote>
<div><p>is possible to orient all the edges.</p>
</div></blockquote>
<dl class="simple">
<dt>If <a href="#id3"><span class="problematic" id="id4">`</span></a>return_type=&quot;skeleton&quot;, returns an undirected graph along</dt><dd><p>with the separating sets.</p>
</dd>
</dl>
</dd>
<dt>significance_level: float (default: 0.01)</dt><dd><p>The statistical tests use this value to compare with the p-value of
the test to decide whether the tested variables are independent or
not.
For all the tests:
if p-value &gt; significance_level, it assumes that the</p>
<blockquote>
<div><p>independence condition satisfied in the data.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Estimated model</strong> -- The estimated model structure, can be a partially directed graph (PDAG)
or a fully directed graph (DAG), or (Undirected Graph, separating sets)
depending on the value of <cite>return_type</cite> argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a>, <a class="reference internal" href="coreBN.base.html#coreBN.base.PDAG" title="coreBN.base.PDAG">coreBN.base.PDAG</a>, or tuple(networkx.UndirectedGraph, dict)</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Original PC: P. Spirtes, C. Glymour, and R. Scheines, Causation,</dt><dd><p>Prediction, and Search, 2nd ed. Cambridge, MA: MIT Press, 2000.</p>
</dd>
<dt>[2] Stable PC:  D. Colombo and M. H. Maathuis, “A modification of the PC algorithm</dt><dd><p>yielding order-independent skeletons,” ArXiv e-prints, Nov. 2012.</p>
</dd>
<dt>[3] Parallel PC: Le, Thuc, et al. &quot;A fast PC algorithm for high dimensional causal</dt><dd><p>discovery with multi-core PCs.&quot; IEEE/ACM transactions on computational
biology and bioinformatics (2016).</p>
</dd>
</dl>
<p>[4] Kernel-PC: Verbyla (2017)</p>
<p>[5] Kernel-PC : Gretton et al. (2009-2015)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">kPC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_dataframe</span><span class="p">(</span><span class="s2">&quot;kpc_basic_example&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">kPC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC.regrVonPS">
<span class="sig-name descname"><span class="pre">regrVonPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsic_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.regrVonPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC.regrVonPS" title="Permalink to this definition"></a></dt>
<dd><p>uses the genralised additive model to non-linearly
and non-parametrically regress variable V on the vars
present in its neighborood, to test residuals  .</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.kPC.skeleton_to_pdag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">skeleton_to_pdag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separating_sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.skeleton_to_pdag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.kPC.skeleton_to_pdag" title="Permalink to this definition"></a></dt>
<dd><p>Orients the edges of a graph skeleton based on information from
<cite>separating_sets</cite> to form a DAG pattern (DAG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.UndirectedGraph" title="coreBN.base.UndirectedGraph"><em>UndirectedGraph</em></a>) -- An undirected graph skeleton as e.g. produced by the
estimate_skeleton method.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model after edge orientation</strong> -- An estimate for the DAG pattern of the BN underlying the data. The
graph might contain some nodes with both-way edges (X-&gt;Y and Y-&gt;X).
Any completion by (removing one of the both-way edges for each such
pair) results in a I-equivalent Bayesian network DAG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)
<a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABD&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="c1"># edges: A-&gt;C, B-&gt;C, A--D (not directed)</span>
<span class="go">[(&#39;B&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;A&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.estimators">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-coreBN.estimators" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BDeuScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">BDeuScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDeuScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BDeuScore.get_number_of_parent_states">
<span class="sig-name descname"><span class="pre">get_number_of_parent_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_counts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore.get_number_of_parent_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDeuScore.get_number_of_parent_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BDeuScore.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDeuScore.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDeuScore.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BDsScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">BDsScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDsScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.BDeuScore" title="coreBN.estimators.StructureScore.BDeuScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">BDeuScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BDsScore.get_number_of_parent_states">
<span class="sig-name descname"><span class="pre">get_number_of_parent_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_counts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.get_number_of_parent_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDsScore.get_number_of_parent_states" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BDsScore.structure_prior">
<span class="sig-name descname"><span class="pre">structure_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.structure_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDsScore.structure_prior" title="Permalink to this definition"></a></dt>
<dd><p>Implements the marginal uniform prior for the graph structure where each arc
is independent with the probability of an arc for any two nodes in either direction
is 1/4 and the probability of no arc between any two nodes is 1/2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BDsScore.structure_prior_ratio">
<span class="sig-name descname"><span class="pre">structure_prior_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BDsScore.structure_prior_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BDsScore.structure_prior_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Return the log ratio of the prior probabilities for a given proposed change to
the DAG.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BaseEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">BaseEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_samples_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#BaseEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BaseEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BaseEstimator.state_counts">
<span class="sig-name descname"><span class="pre">state_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete_samples_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#coreBN.estimators.BaseEstimator.state_counts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">BayesianEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator.estimate_cpd">
<span class="sig-name descname"><span class="pre">estimate_cpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BDeu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator.estimate_cpd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator.estimate_cpd" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the CPD for a given variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>int</em><em>, </em><em>string</em><em> (</em><em>any hashable python object</em><em>)</em>) -- The name of the variable for which the CPD is to be estimated.</p></li>
<li><p><strong>prior_type</strong> (<em>'dirichlet'</em><em>, </em><em>'BDeu'</em><em>, </em><em>'K2'</em><em>,</em>) -- <p>string indicting which type of prior to use for the model parameters.
- If 'prior_type' is 'dirichlet', the following must be provided:</p>
<blockquote>
<div><dl class="simple">
<dt>'pseudo_counts' = dirichlet hyperparameters; a single number or 2-D array</dt><dd><p>of shape (node_card, product of parents_card) with a &quot;virtual&quot; count for
each variable state in the CPD. The virtual counts are added to the
actual state counts found in the data. (if a list is provided, a
lexicographic ordering of states is assumed)</p>
</dd>
</dl>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>If 'prior_type' is 'BDeu', then an 'equivalent_sample_size'</dt><dd><p>must be specified instead of 'pseudo_counts'. This is equivalent to
'prior_type=dirichlet' and using uniform 'pseudo_counts' of
<cite>equivalent_sample_size/(node_cardinality*np.prod(parents_cardinalities))</cite>.</p>
</dd>
</dl>
</li>
<li><p>A prior_type of 'K2' is a shorthand for 'dirichlet' + setting every
pseudo_count to 1, regardless of the cardinality of the variable.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>CPD</strong> -- The estimated CPD for <cite>node</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.CPD.TabularCPD" title="coreBN.factors.discrete.CPD.TabularCPD">TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_C</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;dirichlet&quot;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">pseudo_counts</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>                                              <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cpd_C</span><span class="p">)</span>
<span class="go">╒══════╤══════╤══════╤══════╤════════════════════╕</span>
<span class="go">│ A    │ A(0) │ A(0) │ A(1) │ A(1)               │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ B    │ B(0) │ B(1) │ B(0) │ B(1)               │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ C(0) │ 0.25 │ 0.25 │ 0.5  │ 0.3333333333333333 │</span>
<span class="go">├──────┼──────┼──────┼──────┼────────────────────┤</span>
<span class="go">│ C(1) │ 0.75 │ 0.75 │ 0.5  │ 0.6666666666666666 │</span>
<span class="go">╘══════╧══════╧══════╧══════╧════════════════════╛</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BayesianEstimator.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BDeu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivalent_sample_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pseudo_counts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/BayesianEstimator.html#BayesianEstimator.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BayesianEstimator.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the model parameters (CPDs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prior_type</strong> (<em>'dirichlet'</em><em>, </em><em>'BDeu'</em><em>, or </em><em>'K2'</em>) -- <p>string indicting which type of prior to use for the model parameters.
- If 'prior_type' is 'dirichlet', the following must be provided:</p>
<blockquote>
<div><dl class="simple">
<dt>'pseudo_counts' = dirichlet hyperparameters; a single number or a dict containing, for each</dt><dd><p>variable, a 2-D array of the shape (node_card, product of parents_card) with a &quot;virtual&quot;
count for each variable state in the CPD, that is added to the state counts.
(lexicographic ordering of states assumed)</p>
</dd>
</dl>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>If 'prior_type' is 'BDeu', then an 'equivalent_sample_size'</dt><dd><p>must be specified instead of 'pseudo_counts'. This is equivalent to
'prior_type=dirichlet' and using uniform 'pseudo_counts' of
<cite>equivalent_sample_size/(node_cardinality*np.prod(parents_cardinalities))</cite> for each node.
'equivalent_sample_size' can either be a numerical value or a dict that specifies
the size for each variable separately.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>A prior_type of 'K2' is a shorthand for 'dirichlet' + setting every pseudo_count to 1,</dt><dd><p>regardless of the cardinality of the variable.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>parameters</strong> -- List of TabularCPDs, one for each variable of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">BayesianEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">BayesianEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">prior_type</span><span class="o">=</span><span class="s1">&#39;BDeu&#39;</span><span class="p">,</span> <span class="n">equivalent_sample_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[&lt;TabularCPD representing P(C:2) at 0x7f7b534251d0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(B:2 | C:2, A:2) at 0x7f7b4dfd4da0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(A:2) at 0x7f7b4dfd4fd0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(D:2 | C:2) at 0x7f7b4df822b0&gt;]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.BicScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">BicScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BicScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BicScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.BicScore.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#BicScore.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.BicScore.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.ExpectationMaximization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">ExpectationMaximization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/EM.html#ExpectationMaximization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ExpectationMaximization" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.ExpectationMaximization.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latent_card</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/EM.html#ExpectationMaximization.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ExpectationMaximization.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate all model parameters (CPDs) using Expecation Maximization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latent_card</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- A dictionary of the form {latent_var: cardinality} specifying the
cardinality (number of states) of each latent variable. If None,
assumes <cite>2</cite> states for each latent variable.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em> (</em><em>default: 100</em><em>)</em>) -- The maximum number of iterations the algorithm is allowed to run for.
If max_iter is reached, return the last value of parameters.</p></li>
<li><p><strong>atol</strong> (<em>int</em><em> (</em><em>default: 1e-08</em><em>)</em>) -- The absolute accepted tolerance for checking convergence. If the parameters
change is less than atol in an iteration, the algorithm will exit.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em> (</em><em>default: -1</em><em>)</em>) -- Number of jobs to run in parallel. Default: -1 uses all the processors.
Suggest to use n_jobs=1 when dataset size is less than 1000.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em> (</em><em>default: 1000</em><em>)</em>) -- Number of data used to compute weights in a batch.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) -- The random seed to use for generating the intial values.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- Whether to show a progress bar for iterations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated paramters (CPDs)</strong> -- A list of estimated CPDs for the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">ExpectationMaximization</span> <span class="k">as</span> <span class="n">EM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)],</span> <span class="n">latents</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;B&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">EM</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.HillClimbSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">HillClimbSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/HillClimbSearch.html#HillClimbSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.HillClimbSearch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.HillClimbSearch.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scoring_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k2score'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_dag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_edges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabu_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_indegree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">black_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/HillClimbSearch.html#HillClimbSearch.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.HillClimbSearch.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Performs local hill climb search to estimates the <cite>DAG</cite> structure that
has optimal score, according to the scoring method supplied. Starts at
model <cite>start_dag</cite> and proceeds by step-by-step network modifications
until a local maximum is reached. Only estimates network structure, no
parametrization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scoring_method</strong> (<em>str</em><em> or </em><em>StructureScore instance</em>) -- The score to be optimized during structure estimation.  Supported
structure scores: k2score, bdeuscore, bdsscore, bicscore. Also accepts a
custom score but it should be an instance of <cite>StructureScore</cite>.</p></li>
<li><p><strong>start_dag</strong> (<em>DAG instance</em>) -- The starting point for the local search. By default a completely
disconnected network is used.</p></li>
<li><p><strong>fixed_edges</strong> (<em>iterable</em>) -- A list of edges that will always be there in the final learned model.
The algorithm will add these edges at the start of the algorithm and
will never change it.</p></li>
<li><p><strong>tabu_length</strong> (<em>int</em>) -- If provided, the last <cite>tabu_length</cite> graph modifications cannot be reversed
during the search procedure. This serves to enforce a wider exploration
of the search space. Default value: 100.</p></li>
<li><p><strong>max_indegree</strong> (<em>int</em><em> or </em><em>None</em>) -- If provided and unequal None, the procedure only searches among models
where all nodes have at most <cite>max_indegree</cite> parents. Defaults to None.</p></li>
<li><p><strong>black_list</strong> (<em>list</em><em> or </em><em>None</em>) -- If a list of edges is provided as <cite>black_list</cite>, they are excluded from the search
and the resulting model will not contain any of those edges. Default: None</p></li>
<li><p><strong>white_list</strong> (<em>list</em><em> or </em><em>None</em>) -- If a list of edges is provided as <cite>white_list</cite>, the search is limited to those
edges. The resulting model will then only contain edges that are in <cite>white_list</cite>.
Default: None</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em> (</em><em>default: 1e-4</em><em>)</em>) -- Defines the exit condition. If the improvement in score is less than <cite>epsilon</cite>,
the learned model is returned.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em> (</em><em>default: 1e6</em><em>)</em>) -- The maximum number of iterations allowed. Returns the learned model when the
number of iterations is greater than <cite>max_iter</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated model</strong> -- A <cite>DAG</cite> at a (local) score maximum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">HillClimbSearch</span><span class="p">,</span> <span class="n">BicScore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create data sample with 9 random variables:</span>
<span class="gp">... </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCDEFGHI&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add 10th dependent variable</span>
<span class="gp">... </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">est</span> <span class="o">=</span> <span class="n">HillClimbSearch</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_model</span> <span class="o">=</span> <span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">scoring_method</span><span class="o">=</span><span class="n">BicScore</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>
<span class="go">[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_model</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">OutEdgeView([(&#39;B&#39;, &#39;J&#39;), (&#39;A&#39;, &#39;J&#39;)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># search a model with restriction on the number of parents:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">est</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">max_indegree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">OutEdgeView([(&#39;J&#39;, &#39;A&#39;), (&#39;B&#39;, &#39;J&#39;)])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.IVEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">IVEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#IVEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.IVEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements Instrumental Variable (IV) based estimator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.IVEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ivs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">civs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#IVEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.IVEstimator.fit" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the parameter X -&gt; Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- The covariate variable of the parameter being estimated.</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- The predictor variable of the parameter being estimated.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) -- The data from which to learn the parameter.</p></li>
<li><p><strong>ivs</strong> (<em>List</em><em> (</em><em>default: None</em><em>)</em>) -- List of variable names which should be used as Instrumental Variables (IV).
If not specified, tries to find the IVs from the model structure, fails if
can't find either IV or Conditional IV.</p></li>
<li><p><strong>civs</strong> (<em>List</em><em> of </em><em>tuples</em><em> (</em><em>tuple form:</em><em> (</em><em>var</em><em>, </em><em>coditional_var</em><em>)</em><em>)</em>) -- List of conditional IVs to use for estimation.
If not specified, tries to find the IVs from the model structure, fails if
can't find either IV or Conditional IVs.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">IVEstimator</span> <span class="c1"># TODO: Finish example.</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.K2Score">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">K2Score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#K2Score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.K2Score" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.K2Score.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#K2Score.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.K2Score.local_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score that measures how much a         given variable is &quot;influenced&quot; by a given list of potential parents.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.MaximumLikelihoodEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">MaximumLikelihoodEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MaximumLikelihoodEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.ParameterEstimator" title="coreBN.estimators.Estimator.ParameterEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParameterEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.MaximumLikelihoodEstimator.estimate_cpd">
<span class="sig-name descname"><span class="pre">estimate_cpd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator.estimate_cpd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MaximumLikelihoodEstimator.estimate_cpd" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the CPD for a given variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>int</em><em>, </em><em>string</em><em> (</em><em>any hashable python object</em><em>)</em>) -- The name of the variable for which the CPD is to be estimated.</p></li>
<li><p><strong>weighted</strong> (<em>bool</em>) -- If weighted=True, the data must contain a <cite>_weight</cite> column specifying the
weight of each datapoint (row). If False, assigns an equal weight to each
datapoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated CPD</strong> -- Estimated CPD for <cite>node</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.TabularCPD" title="coreBN.factors.discrete.TabularCPD">coreBN.factors.discrete.TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_A</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">estimate_cpd</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cpd_A</span><span class="p">)</span>
<span class="go">╒══════╤══════════╕</span>
<span class="go">│ A(0) │ 0.666667 │</span>
<span class="go">├──────┼──────────┤</span>
<span class="go">│ A(1) │ 0.333333 │</span>
<span class="go">╘══════╧══════════╛</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.MaximumLikelihoodEstimator.get_parameters">
<span class="sig-name descname"><span class="pre">get_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/MLE.html#MaximumLikelihoodEstimator.get_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.MaximumLikelihoodEstimator.get_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Method to estimate the model parameters (CPDs) using Maximum Likelihood
Estimation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_jobs</strong> (<em>int</em><em> (</em><em>default: -1</em><em>)</em>) -- Number of jobs to run in parallel. Default: -1 uses all the processors.</p></li>
<li><p><strong>weighted</strong> (<em>bool</em>) -- If weighted=True, the data must contain a <cite>_weight</cite> column specifying the
weight of each datapoint (row). If False, assigns an equal weight to each
datapoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated parameters</strong> -- List of coreBN.factors.discrete.TabularCPDs, one for each variable of the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">MaximumLikelihoodEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">MaximumLikelihoodEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">()</span>
<span class="go">[&lt;TabularCPD representing P(C:2) at 0x7f7b534251d0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(B:2 | C:2, A:2) at 0x7f7b4dfd4da0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(A:2) at 0x7f7b4dfd4fd0&gt;,</span>
<span class="go">&lt;TabularCPD representing P(D:2 | C:2) at 0x7f7b4df822b0&gt;]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.PC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">PC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.build_skeleton">
<span class="sig-name descname"><span class="pre">build_skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.build_skeleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.build_skeleton" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a graph skeleton (UndirectedGraph) from a set of independencies
using (the first part of) the PC algorithm. The independencies can either be
provided as an instance of the <cite>Independencies</cite>-class or by passing a
decision function that decides any conditional independency assertion.
Returns a tuple <cite>(skeleton, separating_sets)</cite>.</p>
<p>If an Independencies-instance is passed, the contained IndependenceAssertions
have to admit a faithful BN representation. This is the case if
they are obtained as a set of d-seperations of some Bayesian network or
if the independence assertions are closed under the semi-graphoid axioms.
Otherwise the procedure may fail to identify the correct structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>skeleton</strong> (<em>UndirectedGraph</em>) -- An estimate for the undirected graph skeleton of the BN underlying the data.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation procedures)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)</dt><dd><p><a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
</dd>
<dt>[2] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</dt><dd><p>Section 3.4.2.1 (page 85), Algorithm 3.3</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.base</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.independencies</span> <span class="kn">import</span> <span class="n">Independencies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from list of independencies:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">Independencies</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we need to compute closure, otherwise this set of independencies doesn&#39;t</span>
<span class="gp">... </span><span class="c1"># admit a faithful representation:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="o">.</span><span class="n">closure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">independencies</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="s2">&quot;ABCD&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;D&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;D&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from d-seperations of DAG:</span>
<span class="gp">... </span><span class="n">model</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;E&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iclient</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a DAG/PDAG from the given dataset using the PC algorithm which
is a constraint-based structure learning algorithm[1]. The independencies
in the dataset are identified by doing statistical independece test. This
method returns a DAG/PDAG structure which is faithful to the independencies
implied by the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<em>str</em><em> (</em><em>one</em><em> of </em><em>&quot;orig&quot;</em><em>, </em><em>&quot;stable&quot;</em><em>, </em><em>&quot;parallel&quot;</em><em>)</em>) -- <p>The variant of PC algorithm to run.
&quot;orig&quot;: The original PC algorithm. Might not give the same</p>
<blockquote>
<div><p>results in different runs but does less independence
tests compared to stable.</p>
</div></blockquote>
<dl class="simple">
<dt>&quot;stable&quot;: Gives the same result in every run but does needs to</dt><dd><p>do more statistical independence tests.</p>
</dd>
<dt>&quot;parallel&quot;: Parallel version of PC Stable. Can run on multiple</dt><dd><p>cores with the same result on each run.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ci_test</strong> (<em>str</em><em> or </em><em>fun</em>) -- <p>The statistical test to use for testing conditional independence in
the dataset. If <cite>str</cite> values should be one of:</p>
<blockquote>
<div><dl class="simple">
<dt>&quot;independence_match&quot;: If using this option, an additional parameter</dt><dd><p><cite>independencies</cite> must be specified.</p>
</dd>
<dt>&quot;chi_square&quot;: Uses the Chi-Square independence test. This works</dt><dd><p>only for discrete datasets.</p>
</dd>
<dt>&quot;pearsonr&quot;: Uses the pertial correlation based on pearson</dt><dd><p>correlation coefficient to test independence. This works
only for continuous datasets.</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>max_cond_vars</strong> (<em>int</em>) -- The maximum number of conditional variables allowed to do the statistical
test with.</p></li>
<li><p><strong>return_type</strong> (<em>str</em><em> (</em><em>one</em><em> of </em><em>&quot;dag&quot;</em><em>, </em><em>&quot;cpdag&quot;</em><em>, </em><em>&quot;pdag&quot;</em><em>, </em><em>&quot;skeleton&quot;</em><em>)</em>) -- <p>The type of structure to return.</p>
<p>If <cite>return_type=pdag</cite> or <cite>return_type=cpdag</cite>: a partially directed structure is returned.
If <cite>return_type=dag</cite>, a fully directed structure is returned if it</p>
<blockquote>
<div><p>is possible to orient all the edges.</p>
</div></blockquote>
<dl class="simple">
<dt>If <a href="#id5"><span class="problematic" id="id6">`</span></a>return_type=&quot;skeleton&quot;, returns an undirected graph along</dt><dd><p>with the separating sets.It is the output of the step 1 of the algorithm.</p>
</dd>
</dl>
</p></li>
<li><p><strong>significance_level</strong> (<em>float</em><em> (</em><em>default: 0.01</em><em>)</em>) -- <p>The statistical tests use this value to compare with the p-value of
the test to decide whether the tested variables are independent or
not. Different tests can treat this parameter differently:</p>
<blockquote>
<div><ol class="arabic simple">
<li><dl class="simple">
<dt>Chi-Square: If p-value &gt; significance_level, it assumes that the</dt><dd><p>independence condition satisfied in the data.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>pearsonr: If p-value &gt; significance_level, it assumes that the</dt><dd><p>independence condition satisfied in the data.</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Estimated model</strong> -- The estimated model structure, can be a partially directed graph (PDAG)
or a fully directed graph (DAG), or (Undirected Graph, separating sets)
depending on the value of <cite>return_type</cite> argument.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a>, <a class="reference internal" href="coreBN.base.html#coreBN.base.PDAG" title="coreBN.base.PDAG">coreBN.base.PDAG</a>, or tuple(networkx.UndirectedGraph, dict)</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Original PC: P. Spirtes, C. Glymour, and R. Scheines, Causation,</dt><dd><p>Prediction, and Search, 2nd ed. Cambridge, MA: MIT Press, 2000.</p>
</dd>
<dt>[2] Stable PC:  D. Colombo and M. H. Maathuis, “A modification of the PC algorithm</dt><dd><p>yielding order-independent skeletons,” ArXiv e-prints, Nov. 2012.</p>
</dd>
<dt>[3] Parallel PC: Le, Thuc, et al. &quot;A fast PC algorithm for high dimensional causal</dt><dd><p>discovery with multi-core PCs.&quot; IEEE/ACM transactions on computational
biology and bioinformatics (2016).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;XYZ&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">      X  Y  Z  sum</span>
<span class="go">0     3  0  1    4</span>
<span class="go">1     1  4  3    8</span>
<span class="go">2     0  0  3    3</span>
<span class="go">3     0  2  3    5</span>
<span class="go">4     2  1  1    4</span>
<span class="gp">... </span> <span class="o">..</span> <span class="o">..</span> <span class="o">..</span>  <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;Z&#39;, &#39;sum&#39;), (&#39;X&#39;, &#39;sum&#39;), (&#39;Y&#39;, &#39;sum&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.PC.skeleton_to_pdag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">skeleton_to_pdag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separating_sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/PC.html#PC.skeleton_to_pdag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.PC.skeleton_to_pdag" title="Permalink to this definition"></a></dt>
<dd><p>Orients the edges of a graph skeleton based on information from
<cite>separating_sets</cite> to form a DAG pattern (DAG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.UndirectedGraph" title="coreBN.base.UndirectedGraph"><em>UndirectedGraph</em></a>) -- An undirected graph skeleton as e.g. produced by the
estimate_skeleton method.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model after edge orientation</strong> -- An estimate for the DAG pattern of the BN underlying the data. The
graph might contain some nodes with both-way edges (X-&gt;Y and Y-&gt;X).
Any completion by (removing one of the both-way edges for each such
pair) results in a I-equivalent Bayesian network DAG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)
<a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABD&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="c1"># edges: A-&gt;C, B-&gt;C, A--D (not directed)</span>
<span class="go">[(&#39;B&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;A&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.ParameterEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">ParameterEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#ParameterEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ParameterEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.ParameterEstimator.state_counts">
<span class="sig-name descname"><span class="pre">state_counts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#ParameterEstimator.state_counts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ParameterEstimator.state_counts" title="Permalink to this definition"></a></dt>
<dd><p>Return counts how often each state of 'variable' occurred in the data.
If the variable has parents, counting is done conditionally
for each state configuration of the parents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variable</strong> (<em>string</em>) -- Name of the variable for which the state count is to be done.</p></li>
<li><p><strong>complete_samples_only</strong> (<em>bool</em>) -- Specifies how to deal with missing data, if present. If set to <cite>True</cite> all rows
that contain <cite>np.NaN</cite> somewhere are ignored. If <cite>False</cite> then
every row where neither the variable nor its parents are <cite>np.NaN</cite> is used.
Desired default behavior can be passed to the class constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>state_counts</strong> -- Table with state counts for 'variable'</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">ParameterEstimator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">],</span>
<span class="go">                              &#39;B&#39;: [&#39;b1&#39;, &#39;b2&#39;, &#39;b1&#39;],</span>
<span class="go">                              &#39;C&#39;: [&#39;c1&#39;, &#39;c1&#39;, &#39;c2&#39;]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">ParameterEstimator</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">    A</span>
<span class="go">a1  2</span>
<span class="go">a2  1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span><span class="o">.</span><span class="n">state_counts</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="go">A  a1      a2</span>
<span class="go">B  b1  b2  b1  b2</span>
<span class="go">C</span>
<span class="go">c1  1   1   0   0</span>
<span class="go">c2  0   0   1   0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">SEMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class of SEM estimators. All the estimators inherit this class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exit_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.fit" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the parameters of the model from the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas DataFrame</em><em> or </em><em>coreBN.data.Data instance</em>) -- The data from which to estimate the parameters of the model.</p></li>
<li><p><strong>method</strong> (<em>str</em><em> (</em><em>&quot;ml&quot;</em><em>|</em><em>&quot;uls&quot;</em><em>|</em><em>&quot;gls&quot;</em><em>|</em><em>&quot;2sls&quot;</em><em>)</em>) -- The fitting function to use.
ML : Maximum Likelihood
ULS: Unweighted Least Squares
GLS: Generalized Least Squares
2sls: 2-SLS estimator</p></li>
<li><p><strong>init_values</strong> (<em>str</em><em> or </em><em>dict</em>) -- Options for str: random | std | iv
dict: dictionary with keys <cite>B</cite> and <cite>zeta</cite>.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) -- <p>Extra parameters required in case of some estimators.
GLS:</p>
<blockquote>
<div><p>W: np.array (n x n) where n is the number of observe variables.</p>
</div></blockquote>
<dl class="simple">
<dt>2sls:</dt><dd><p>x:
y:</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coreBN.model.SEM instance</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Instance of the model with estimated parameters</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Bollen, K. A. (2010). Structural equations with latent variables. New York: Wiley.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.get_init_values">
<span class="sig-name descname"><span class="pre">get_init_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.get_init_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.get_init_values" title="Permalink to this definition"></a></dt>
<dd><p>Computes the starting values for the optimizer.</p>
<section id="id7">
<h3>Reference<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>Bollen, K. (2014). Structural Equations with Latent Variables.</dt><dd><p>New York, NY: John Wiley &amp; Sons.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.gls_loss">
<span class="sig-name descname"><span class="pre">gls_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.gls_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.gls_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Weighted Least Squares fitting function. The optimizer calls
this method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ULS} = tr { [(S - Sigma(theta)) W^{-1}]^2 }</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.ml_loss">
<span class="sig-name descname"><span class="pre">ml_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.ml_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.ml_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Maximum Likelihood loss function. The optimizer calls this
method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ML} = log <a href="#id12"><span class="problematic" id="id13">|\Sigma(\theta)|</span></a> + tr(S Sigma^{-1}(theta)) - log S - (p+q)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.SEMEstimator.uls_loss">
<span class="sig-name descname"><span class="pre">uls_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/SEMEstimator.html#SEMEstimator.uls_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.SEMEstimator.uls_loss" title="Permalink to this definition"></a></dt>
<dd><p>Method to compute the Unweighted Least Squares fitting function. The optimizer calls
this method after each iteration with updated params to compute the new loss.</p>
<p>The fitting function for ML is:
.. math:: F_{ULS} = tr[(S - Sigma(theta))^2]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em>) -- params contain all the variables which are updated in each iteration of the
optimization.</p></li>
<li><p><strong>loss_args</strong> (<em>dict</em>) -- loss_args contain all the variable which are not updated in each iteration but
are required to compute the loss.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>torch.tensor</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>The loss value for the given params and loss_args</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.ScoreCache">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">ScoreCache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_scorer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/ScoreCache.html#ScoreCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ScoreCache" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.StructureScore.StructureScore" title="coreBN.estimators.StructureScore.StructureScore"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureScore</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.ScoreCache.local_score">
<span class="sig-name descname"><span class="pre">local_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parents</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/ScoreCache.html#ScoreCache.local_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.ScoreCache.local_score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">StructureEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#StructureEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureEstimator.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/Estimator.html#StructureEstimator.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureEstimator.estimate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">StructureScore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.BaseEstimator" title="coreBN.estimators.Estimator.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.score" title="Permalink to this definition"></a></dt>
<dd><p>Computes a score to measure how well the given <cite>BayesianNetwork</cite> fits
to the data set.  (This method relies on the <cite>local_score</cite>-method that
is implemented in each subclass.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>BayesianNetwork instance</em>) -- The Bayesian network that is to be scored. Nodes of the BayesianNetwork need to coincide
with column names of data set.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>score</strong> -- A number indicating the degree of fit between data and model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">K2Score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># create random data sample with 3 variables, where B and C are identical:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">BayesianNetwork</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]]))</span>
<span class="go">-24242.367348745247</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K2Score</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">BayesianNetwork</span><span class="p">([[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">]]))</span>
<span class="go">-16273.793897051042</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.structure_prior">
<span class="sig-name descname"><span class="pre">structure_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.structure_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.structure_prior" title="Permalink to this definition"></a></dt>
<dd><p>A (log) prior distribution over models. Currently unused (= uniform).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.StructureScore.structure_prior_ratio">
<span class="sig-name descname"><span class="pre">structure_prior_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operation</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/StructureScore.html#StructureScore.structure_prior_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.StructureScore.structure_prior_ratio" title="Permalink to this definition"></a></dt>
<dd><p>Return the log ratio of the prior probabilities for a given proposed change to the DAG.
Currently unused (=uniform).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.estimators.kPC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.estimators.</span></span><span class="sig-name descname"><span class="pre">kPC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independencies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.estimators.Estimator.StructureEstimator" title="coreBN.estimators.Estimator.StructureEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructureEstimator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.PDAG_by_Meek_rules">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PDAG_by_Meek_rules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.PDAG_by_Meek_rules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.PDAG_by_Meek_rules" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.build_skeleton">
<span class="sig-name descname"><span class="pre">build_skeleton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsic_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dask_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rstate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.build_skeleton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.build_skeleton" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a graph skeleton (UndirectedGraph) from a set of independencies
using (the first part of) the PC algorithm. The independencies can either be
provided as an instance of the <cite>Independencies</cite>-class or by passing a
decision function that decides any conditional independency assertion.
Returns a tuple <cite>(skeleton, separating_sets)</cite>.</p>
<p>If an Independencies-instance is passed, the contained IndependenceAssertions
have to admit a faithful BN representation. This is the case if
they are obtained as a set of d-seperations of some Bayesian network or
if the independence assertions are closed under the semi-graphoid axioms.
Otherwise the procedure may fail to identify the correct structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>skeleton</strong> (<em>UndirectedGraph</em>) -- An estimate for the undirected graph skeleton of the BN underlying the data.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation procedures)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)</dt><dd><p><a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
</dd>
<dt>[2] Koller &amp; Friedman, Probabilistic Graphical Models - Principles and Techniques, 2009</dt><dd><p>Section 3.4.2.1 (page 85), Algorithm 3.3</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.base</span> <span class="kn">import</span> <span class="n">DAG</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.independencies</span> <span class="kn">import</span> <span class="n">Independencies</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from list of independencies:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">Independencies</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># we need to compute closure, otherwise this set of independencies doesn&#39;t</span>
<span class="gp">... </span><span class="c1"># admit a faithful representation:</span>
<span class="gp">... </span><span class="n">ind</span> <span class="o">=</span> <span class="n">ind</span><span class="o">.</span><span class="n">closure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">independencies</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="s2">&quot;ABCD&quot;</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;D&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;D&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># build skeleton from d-seperations of DAG:</span>
<span class="gp">... </span><span class="n">model</span> <span class="o">=</span> <span class="n">DAG</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">skel</span><span class="p">,</span> <span class="n">sep_sets</span> <span class="o">=</span> <span class="n">PC</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span> <span class="n">model</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">skel</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
<span class="go">[(&#39;A&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;C&#39;), (&#39;B&#39;, &#39;D&#39;), (&#39;C&#39;, &#39;E&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.estimate">
<span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dcc_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dask_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.estimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.estimate" title="Permalink to this definition"></a></dt>
<dd><p>Estimates a DAG/PDAG from the given dataset using the kernel PC algorithm which
is a generalization of the PC algorithm, the most common constraint-based structure learning algorithm[1].
The conditional independencies among the variables in the dataset are identified by doing statistical independece test.
This method returns a DAG/PDAG structure which is faithful to the independencies
implied by the dataset.</p>
<p>It can be applied to continuous vars with priors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variant</strong> (<em>str</em><em> (</em><em>&quot;stable&quot;</em><em>, </em><em>&quot;parallel&quot;</em><em>)</em>) -- <p>The variant of PC algorithm to run.
&quot;orig&quot;: The original PC algorithm. Might not give the same</p>
<blockquote>
<div><p>results in different runs but does less independence
tests compared to stable.</p>
</div></blockquote>
<dl class="simple">
<dt>&quot;stable&quot;: Gives the same result in every run but does needs to</dt><dd><p>do more statistical independence tests.</p>
</dd>
<dt>&quot;parallel&quot;: Parallel version of PC Stable. Can run on multiple</dt><dd><p>cores with the same result on each run.</p>
</dd>
</dl>
</p></li>
<li><p><strong>ci_test</strong> (<em>str</em><em> or </em><em>fun</em>) -- The statistical tests to use for testing conditional independence in
the dataset of continuous non gaussian vars are:
-&quot;HSIC-GAMMA&quot;
-&quot;HSIC-PERM&quot;
-&quot;DCOV-GAMMA&quot;
-&quot;DCOV-PERM&quot;</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>return_type: str (one of &quot;dag&quot;, &quot;cpdag&quot;, &quot;pdag&quot;, &quot;skeleton&quot;)</dt><dd><p>The type of structure to return.</p>
<p>If <cite>return_type=pdag</cite> or <cite>return_type=cpdag</cite>: a partially directed structure is returned.
If <cite>return_type=dag</cite>, a fully directed structure is returned if it</p>
<blockquote>
<div><p>is possible to orient all the edges.</p>
</div></blockquote>
<dl class="simple">
<dt>If <a href="#id8"><span class="problematic" id="id9">`</span></a>return_type=&quot;skeleton&quot;, returns an undirected graph along</dt><dd><p>with the separating sets.</p>
</dd>
</dl>
</dd>
<dt>significance_level: float (default: 0.01)</dt><dd><p>The statistical tests use this value to compare with the p-value of
the test to decide whether the tested variables are independent or
not.
For all the tests:
if p-value &gt; significance_level, it assumes that the</p>
<blockquote>
<div><p>independence condition satisfied in the data.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Estimated model</strong> -- The estimated model structure, can be a partially directed graph (PDAG)
or a fully directed graph (DAG), or (Undirected Graph, separating sets)
depending on the value of <cite>return_type</cite> argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a>, <a class="reference internal" href="coreBN.base.html#coreBN.base.PDAG" title="coreBN.base.PDAG">coreBN.base.PDAG</a>, or tuple(networkx.UndirectedGraph, dict)</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] Original PC: P. Spirtes, C. Glymour, and R. Scheines, Causation,</dt><dd><p>Prediction, and Search, 2nd ed. Cambridge, MA: MIT Press, 2000.</p>
</dd>
<dt>[2] Stable PC:  D. Colombo and M. H. Maathuis, “A modification of the PC algorithm</dt><dd><p>yielding order-independent skeletons,” ArXiv e-prints, Nov. 2012.</p>
</dd>
<dt>[3] Parallel PC: Le, Thuc, et al. &quot;A fast PC algorithm for high dimensional causal</dt><dd><p>discovery with multi-core PCs.&quot; IEEE/ACM transactions on computational
biology and bioinformatics (2016).</p>
</dd>
</dl>
<p>[4] Kernel-PC: Verbyla (2017)</p>
<p>[5] Kernel-PC : Gretton et al. (2009-2015)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">kPC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_dataframe</span><span class="p">(</span><span class="s2">&quot;kpc_basic_example&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">kPC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">estimate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.regrVonPS">
<span class="sig-name descname"><span class="pre">regrVonPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsic_gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.regrVonPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.regrVonPS" title="Permalink to this definition"></a></dt>
<dd><p>uses the genralised additive model to non-linearly
and non-parametrically regress variable V on the vars
present in its neighborood, to test residuals  .</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.estimators.kPC.skeleton_to_pdag">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">skeleton_to_pdag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skeleton</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separating_sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/estimators/kPC.html#kPC.skeleton_to_pdag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.estimators.kPC.skeleton_to_pdag" title="Permalink to this definition"></a></dt>
<dd><p>Orients the edges of a graph skeleton based on information from
<cite>separating_sets</cite> to form a DAG pattern (DAG).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skeleton</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.UndirectedGraph" title="coreBN.base.UndirectedGraph"><em>UndirectedGraph</em></a>) -- An undirected graph skeleton as e.g. produced by the
estimate_skeleton method.</p></li>
<li><p><strong>separating_sets</strong> (<em>dict</em>) -- A dict containing for each pair of not directly connected nodes a
separating set (&quot;witnessing set&quot;) of variables that makes then
conditionally independent. (needed for edge orientation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model after edge orientation</strong> -- An estimate for the DAG pattern of the BN underlying the data. The
graph might contain some nodes with both-way edges (X-&gt;Y and Y-&gt;X).
Any completion by (removing one of the both-way edges for each such
pair) results in a I-equivalent Bayesian network DAG.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG">coreBN.base.DAG</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Neapolitan, Learning Bayesian Networks, Section 10.1.2, Algorithm 10.2 (page 550)
<a class="reference external" href="http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf">http://www.cs.technion.ac.il/~dang/books/Learning%20Bayesian%20Networks(Neapolitan,%20Richard).pdf</a></p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.estimators</span> <span class="kn">import</span> <span class="n">PC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABD&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">PC</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">skeleton_to_pdag</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="o">.</span><span class="n">build_skeleton</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdag</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span> <span class="c1"># edges: A-&gt;C, B-&gt;C, A--D (not directed)</span>
<span class="go">[(&#39;B&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;C&#39;), (&#39;A&#39;, &#39;D&#39;), (&#39;D&#39;, &#39;A&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coreBN.base.html" class="btn btn-neutral float-left" title="coreBN.base package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coreBN.extern.html" class="btn btn-neutral float-right" title="coreBN.extern package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Serafina Di Gioia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>