<!DOCTYPE html>
<html class="writer-html5" lang="English/Python">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coreBN.inference package &mdash; gABi 00.00.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="coreBN.metrics package" href="coreBN.metrics.html" />
    <link rel="prev" title="coreBN.independencies package" href="coreBN.independencies.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            gABi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">coreBN</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="coreBN.html">coreBN package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="coreBN.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="coreBN.CItests.html">coreBN.CItests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.IO.html">coreBN.IO package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.base.html">coreBN.base package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.estimators.html">coreBN.estimators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.extern.html">coreBN.extern package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.factors.html">coreBN.factors package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.independencies.html">coreBN.independencies package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">coreBN.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.metrics.html">coreBN.metrics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.models.html">coreBN.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.sampling.html">coreBN.sampling package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.tests.html">coreBN.tests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.utils.html">coreBN.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN.global_vars">coreBN.global_vars module</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gABi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">coreBN</a></li>
          <li class="breadcrumb-item"><a href="coreBN.html">coreBN package</a></li>
      <li class="breadcrumb-item active">coreBN.inference package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/coreBN.inference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="corebn-inference-package">
<h1>coreBN.inference package<a class="headerlink" href="#corebn-inference-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-coreBN.inference.ApproxInference">
<span id="corebn-inference-approxinference-module"></span><h2>coreBN.inference.ApproxInference module<a class="headerlink" href="#module-coreBN.inference.ApproxInference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference.ApproxInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.ApproxInference.</span></span><span class="sig-name descname"><span class="pre">ApproxInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference.ApproxInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference.ApproxInference.get_distribution">
<span class="sig-name descname"><span class="pre">get_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference.get_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference.ApproxInference.get_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Computes distribution of <cite>variables</cite> from given data <cite>samples</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) -- A dataframe of samples generated from the model.</p></li>
<li><p><strong>variables</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of variables whose distribution needs to be computed.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em>) -- If joint=True, computes the joint distribution over <cite>variables</cite>.
Else, returns a dict with marginal distribution of each variable in
<cite>variables</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference.ApproxInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference.ApproxInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Method for doing approximate inference based on sampling in Bayesian
Networks and Dynamic Bayesian Networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- List of variables for which the probability distribution needs to be calculated.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) -- The number of samples to generate for computing the distributions. Higher <cite>n_samples</cite>
results in more accurate results at the cost of more computation time.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- The observed values. A dict key, value pair of the form {var: state_name}.</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default: None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual/soft
evidence.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- If True, shows a progress bar when generating samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Probability distribution</strong> -- The queried probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.TabularCPD" title="coreBN.factors.discrete.TabularCPD">coreBN.factors.discrete.TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">ApproxInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span> <span class="o">=</span> <span class="n">ApproxInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HISTORY&quot;</span><span class="p">])</span>
<span class="go">&lt;DiscreteFactor representing phi(HISTORY:2) at 0x7f92d9f5b910&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.inference.CausalInference">
<span id="corebn-inference-causalinference-module"></span><h2>coreBN.inference.CausalInference module<a class="headerlink" href="#module-coreBN.inference.CausalInference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.CausalInference.</span></span><span class="sig-name descname"><span class="pre">CausalInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is an inference class for performing Causal Inference over Bayesian Networks or Structural Equation Models.</p>
<dl class="simple">
<dt>This class will accept queries of the form: P(Y | do(X)) and utilize its methods to provide an estimand which:</dt><dd><ul class="simple">
<li><p>Identifies adjustment variables</p></li>
<li><p>Backdoor Adjustment</p></li>
<li><p>Front Door Adjustment</p></li>
<li><p>Instrumental Variable Adjustment</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>CausalGraph</em>) -- The model that we'll perform inference over.</p></li>
<li><p><strong>set_nodes</strong> (<em>list</em><em>[</em><em>node:str</em><em>] or </em><em>None</em>) -- A list (or set/tuple) of nodes in the Bayesian Network which have been set to a specific value per the
do-operator.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a small Bayesian Network.
&gt;&gt;&gt; from coreBN.models import BayesianNetwork
&gt;&gt;&gt; game = BayesianNetwork([('X', 'A'),
...                         ('A', 'Y'),
...                         ('A', 'B')])</p>
<p>Load the graph into the CausalInference object to make causal queries.
&gt;&gt;&gt; from coreBN.inference.CausalInference import CausalInference
&gt;&gt;&gt; inference = CausalInference(game)
&gt;&gt;&gt; inference.get_all_backdoor_adjustment_sets(X=&quot;X&quot;, Y=&quot;Y&quot;)
&gt;&gt;&gt; inference.get_all_frontdoor_adjustment_sets(X=&quot;X&quot;, Y=&quot;Y&quot;)</p>
<p class="rubric">References</p>
<p>'Causality: Models, Reasoning, and Inference' - Judea Pearl (2000)</p>
<p>Many thanks to &#64;ijmbarr for their implementation of Causal Graphical models available on GitHub: <a class="reference external" href="https://github.com/ijmbarr/causalgraphicalmodels">https://github.com/ijmbarr/causalgraphicalmodels</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.estimate_ate">
<span class="sig-name descname"><span class="pre">estimate_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimand_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smallest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.estimate_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.estimate_ate" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the average treatment effect (ATE) of X on Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) -- All observed data for this Bayesian Network.</p></li>
<li><p><strong>estimand_strategy</strong> (<em>str</em><em> or </em><em>frozenset</em>) -- <p>Either specify a specific backdoor adjustment set or a strategy.
The available options are:</p>
<blockquote>
<div><dl class="simple">
<dt>smallest:</dt><dd><p>Use the smallest estimand of observed variables</p>
</dd>
<dt>all:</dt><dd><p>Estimate the ATE from each identified estimand</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>estimator_type</strong> (<em>str</em>) -- <p>The type of model to be used to estimate the ATE.
All of the linear regression classes in statsmodels are available including:</p>
<blockquote>
<div><ul>
<li><p>GLS: generalized least squares for arbitrary covariance</p></li>
<li><p>OLS: ordinary least square of i.i.d. errors</p></li>
<li><p>WLS: weighted least squares for heteroskedastic error</p></li>
</ul>
</div></blockquote>
<p>Specify them with their acronym (e.g. &quot;OLS&quot;) or simple &quot;linear&quot; as an alias for OLS.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) -- <p>Keyward arguments specific to the selected estimator.
linear:</p>
<blockquote>
<div><dl class="simple">
<dt>missing: str</dt><dd><p>Available options are &quot;none&quot;, &quot;drop&quot;, or &quot;raise&quot;</p>
</dd>
</dl>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The average treatment effect</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">estimate_ate</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator_type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.get_all_backdoor_adjustment_sets">
<span class="sig-name descname"><span class="pre">get_all_backdoor_adjustment_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_all_backdoor_adjustment_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.get_all_backdoor_adjustment_sets" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of all adjustment sets per the back-door criterion.</p>
<dl class="simple">
<dt>A set of variables Z satisfies the back-door criterion relative to an ordered pair of variabies (Xi, Xj) in a DAG G if:</dt><dd><ol class="lowerroman simple">
<li><p>no node in Z is a descendant of Xi; and</p></li>
<li><p>Z blocks every path between Xi and Xj that contains an arrow into Xi.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frozenset</strong> (<em>A frozenset of frozensets</em>)</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">get_all_backdoor_adjustment_sets</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="go">frozenset()</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>&quot;Causality: Models, Reasoning, and Inference&quot;, Judea Pearl (2000). p.79.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.get_all_frontdoor_adjustment_sets">
<span class="sig-name descname"><span class="pre">get_all_frontdoor_adjustment_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_all_frontdoor_adjustment_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.get_all_frontdoor_adjustment_sets" title="Permalink to this definition"></a></dt>
<dd><p>Identify possible sets of variables, Z, which satisify the front-door criterion relative to given X and Y.</p>
<dl class="simple">
<dt>Z satisifies the front-door critierion if:</dt><dd><ol class="lowerroman simple">
<li><p>Z intercepts all directed paths from X to Y</p></li>
<li><p>there is no backdoor path from X to Z</p></li>
<li><p>all back-door paths from Z to Y are blocked by X</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frozenset</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>a frozenset of frozensets</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Causality: Models, Reasoning, and Inference, Judea Pearl (2000). p.82.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.get_distribution">
<span class="sig-name descname"><span class="pre">get_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.get_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Returns a string representing the factorized distribution implied by the CGM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.get_minimal_adjustment_set">
<span class="sig-name descname"><span class="pre">get_minimal_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_minimal_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.get_minimal_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Method to test whether <cite>adjustment_set</cite> is a valid adjustment set for
identifying the causal effect of <cite>X</cite> on <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em><em> (</em><em>variable name</em><em>)</em>) -- The cause/exposure variables.</p></li>
<li><p><strong>Y</strong> (<em>str</em><em> (</em><em>variable name</em><em>)</em>) -- The outcome variable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Minimal adjustment set</strong> -- A set of variables which are the minimal possible adjustment set. If
None, no adjutment set is possible.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set or None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.get_proper_backdoor_graph">
<span class="sig-name descname"><span class="pre">get_proper_backdoor_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_proper_backdoor_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.get_proper_backdoor_graph" title="Permalink to this definition"></a></dt>
<dd><p>Returns a proper backdoor graph for the exposure <cite>X</cite> and outcome <cite>Y</cite>.
A proper backdoor graph is a graph which remove the first edge of every
proper causal path from <cite>X</cite> to <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of exposure variables.</p></li>
<li><p><strong>Y</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of outcome variables</p></li>
<li><p><strong>inplace</strong> (<em>boolean</em>) -- If inplace is True, modifies the object itself. Otherwise retuns
a modified copy of self.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">CausalInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;z1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;z1&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s2">&quot;z2&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span><span class="o">.</span><span class="n">get_proper_backdoor_graph</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">],</span> <span class="n">Y</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y1&quot;</span><span class="p">,</span> <span class="s2">&quot;y2&quot;</span><span class="p">])</span>
<span class="go">&lt;coreBN.models.BayesianNetwork.BayesianNetwork at 0x7fba501ad940&gt;</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.is_valid_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjustment_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.is_valid_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Method to test whether <cite>adjustment_set</cite> is a valid adjustment set for
identifying the causal effect of <cite>X</cite> on <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of cause variables.</p></li>
<li><p><strong>Y</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of predictor variables.</p></li>
<li><p><strong>adjustment_set</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of variables for which to test whether they satisfy the
adjustment set criteria.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is valid adjustment set</strong> -- Returns True if <cite>adjustment_set</cite> is a valid adjustment set for
identifying the effect of <cite>X</cite> on <cite>Y</cite>. Else returns False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">CausalInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;z1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;z1&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s2">&quot;z2&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span><span class="o">.</span><span class="n">is_valid_adjustment_set</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="n">Y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">],</span> <span class="n">adjustment_set</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">,</span> <span class="s1">&#39;z2&#39;</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.is_valid_backdoor_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_backdoor_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_backdoor_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.is_valid_backdoor_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Test whether Z is a valid backdoor adjustment set for estimating the causal impact of X on Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>Z</strong> (<em>str</em><em> or </em><em>set</em><em>[</em><em>str</em><em>]</em>) -- Adjustment variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is a valid backdoor adjustment set</strong> -- True if Z is a valid backdoor adjustment set else False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">is_valid_backdoor_adjustment_set</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.is_valid_frontdoor_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_frontdoor_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_frontdoor_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.is_valid_frontdoor_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Test whether Z is a valid frontdoor adjustment set for estimating the causal impact of X on Y via the frontdoor
adjustment formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>Z</strong> (<em>set</em>) -- Adjustment variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is valid frontdoor adjusment</strong> -- True if Z is a valid frontdoor adjustment set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjustment_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ve'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Performs a query on the model of the form <span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span> where <span class="math notranslate nohighlight">\(X\)</span>
is <cite>variables</cite>, <span class="math notranslate nohighlight">\(Y\)</span> is <cite>do</cite> and <cite>Z</cite> is the <cite>evidence</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables in the query i.e. <cite>X</cite> in <span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span>.</p></li>
<li><p><strong>do</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- Dictionary of the form {variable_name: variable_state} representing
the variables on which to apply the do operation i.e. <cite>Y</cite> in
<span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span>.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- Dictionary of the form {variable_name: variable_state} repesenting
the conditional variables in the query i.e. <cite>Z</cite> in <span class="math notranslate nohighlight">\(P(X |
do(Y), Z)\)</span>.</p></li>
<li><p><strong>adjustment_set</strong> (<em>str</em><em> or </em><em>list</em><em> (</em><em>default=None</em><em>)</em>) -- Specifies the adjustment set to use. If None, uses the parents of the
do variables as the adjustment set.</p></li>
<li><p><strong>inference_algo</strong> (<em>str</em><em> or </em><em>coreBN.inference.Inference instance</em>) -- The inference algorithm to use to compute the probability values.
String options are: 1) ve: Variable Elimination 2) bp: Belief
Propagation.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) -- Additional paramters which needs to be passed to inference
algorithms.  Please refer to the coreBN.inference.Inference for
details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Queried distribution</strong> -- A factor object representing the joint distribution over the variables in <cite>variables</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coreBN.factor.discrete.DiscreteFactor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s1">&#39;alarm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">],</span> <span class="n">do</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CVP&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">},</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;HR&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">})</span>
<span class="go">&lt;DiscreteFactor representing phi(HISTORY:2) at 0x7f4e0874c2e0&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.CausalInference.simple_decision">
<span class="sig-name descname"><span class="pre">simple_decision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adjustment_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.simple_decision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.CausalInference.simple_decision" title="Permalink to this definition"></a></dt>
<dd><p>Selects the smallest set from provided adjustment sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adjustment_sets</strong> (<em>iterable</em>) -- A frozenset or list of valid adjustment sets</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>frozenset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.inference.EliminationOrder">
<span id="corebn-inference-eliminationorder-module"></span><h2>coreBN.inference.EliminationOrder module<a class="headerlink" href="#module-coreBN.inference.EliminationOrder" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.BaseEliminationOrder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.EliminationOrder.</span></span><span class="sig-name descname"><span class="pre">BaseEliminationOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#BaseEliminationOrder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for finding elimination orders.</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.BaseEliminationOrder.cost">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#BaseEliminationOrder.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder.cost" title="Permalink to this definition"></a></dt>
<dd><p>The cost function to compute the cost of elimination of each node.
This method is just a dummy and returns 0 for all the nodes. Actual cost functions
are implemented in the classes inheriting BaseEliminationOrder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<em>string</em><em>, </em><em>any hashable python object.</em>) -- The node whose cost is to be computed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.BaseEliminationOrder.fill_in_edges">
<span class="sig-name descname"><span class="pre">fill_in_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#BaseEliminationOrder.fill_in_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder.fill_in_edges" title="Permalink to this definition"></a></dt>
<dd><p>Return edges needed to be added to the graph if a node is removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>node</strong> (<em>string</em><em> (</em><em>any hashable python object</em><em>)</em>) -- Node to be removed from the graph.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.BaseEliminationOrder.get_elimination_order">
<span class="sig-name descname"><span class="pre">get_elimination_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#BaseEliminationOrder.get_elimination_order"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder.get_elimination_order" title="Permalink to this definition"></a></dt>
<dd><p>Returns the optimal elimination order based on the cost function.
The node having the least cost is removed first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nodes</strong> (<em>list</em><em>, </em><em>tuple</em><em>, </em><em>set</em><em> (</em><em>array-like</em><em>)</em>) -- The variables which are to be eliminated.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference.EliminationOrder</span> <span class="kn">import</span> <span class="n">WeightedMinFill</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_c</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_d</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_g</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_i</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_s</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_j</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_l</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_h</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_c</span><span class="p">,</span> <span class="n">cpd_d</span><span class="p">,</span> <span class="n">cpd_g</span><span class="p">,</span> <span class="n">cpd_i</span><span class="p">,</span> <span class="n">cpd_s</span><span class="p">,</span> <span class="n">cpd_j</span><span class="p">,</span>
<span class="gp">... </span>               <span class="n">cpd_l</span><span class="p">,</span> <span class="n">cpd_h</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WeightedMinFill</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">get_elimination_order</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">])</span>
<span class="go">[&#39;c&#39;, &#39;s&#39;, &#39;l&#39;, &#39;d&#39;, &#39;g&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WeightedMinFill</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">get_elimination_order</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">])</span>
<span class="go">[&#39;c&#39;, &#39;s&#39;, &#39;l&#39;, &#39;d&#39;, &#39;g&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">WeightedMinFill</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">get_elimination_order</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">])</span>
<span class="go">[&#39;c&#39;, &#39;s&#39;, &#39;l&#39;, &#39;d&#39;, &#39;g&#39;]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinFill">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.EliminationOrder.</span></span><span class="sig-name descname"><span class="pre">MinFill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinFill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinFill" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder" title="coreBN.inference.EliminationOrder.BaseEliminationOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEliminationOrder</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinFill.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinFill.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinFill.cost" title="Permalink to this definition"></a></dt>
<dd><p>The cost of a eliminating a node is the number of edges that need to be added
(fill in edges) to the graph due to its elimination</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinNeighbors">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.EliminationOrder.</span></span><span class="sig-name descname"><span class="pre">MinNeighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinNeighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinNeighbors" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder" title="coreBN.inference.EliminationOrder.BaseEliminationOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEliminationOrder</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinNeighbors.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinNeighbors.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinNeighbors.cost" title="Permalink to this definition"></a></dt>
<dd><p>The cost of a eliminating a node is the number of neighbors it has in the
current graph.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinWeight">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.EliminationOrder.</span></span><span class="sig-name descname"><span class="pre">MinWeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinWeight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinWeight" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder" title="coreBN.inference.EliminationOrder.BaseEliminationOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEliminationOrder</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.MinWeight.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#MinWeight.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.MinWeight.cost" title="Permalink to this definition"></a></dt>
<dd><p>The cost of a eliminating a node is the product of weights, domain cardinality,
of its neighbors.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.WeightedMinFill">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.EliminationOrder.</span></span><span class="sig-name descname"><span class="pre">WeightedMinFill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#WeightedMinFill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.WeightedMinFill" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.EliminationOrder.BaseEliminationOrder" title="coreBN.inference.EliminationOrder.BaseEliminationOrder"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEliminationOrder</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.EliminationOrder.WeightedMinFill.cost">
<span class="sig-name descname"><span class="pre">cost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/EliminationOrder.html#WeightedMinFill.cost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.EliminationOrder.WeightedMinFill.cost" title="Permalink to this definition"></a></dt>
<dd><p>Cost function for WeightedMinFill.
The cost of eliminating a node is the sum of weights of the edges that need to
be added to the graph due to its elimination, where a weight of an edge is the
product of the weights, domain cardinality, of its constituent vertices.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.inference.ExactInference">
<span id="corebn-inference-exactinference-module"></span><h2>coreBN.inference.ExactInference module<a class="headerlink" href="#module-coreBN.inference.ExactInference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.ExactInference.</span></span><span class="sig-name descname"><span class="pre">BeliefPropagation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<p>Class for performing inference using Belief Propagation method.</p>
<p>Creates a Junction Tree or Clique Tree (JunctionTree class) for the input
probabilistic graphical model and performs calibration of the junction tree
so formed using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>BayesianNetwork</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.MarkovNetwork" title="coreBN.models.MarkovNetwork"><em>MarkovNetwork</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.FactorGraph" title="coreBN.models.FactorGraph"><em>FactorGraph</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.JunctionTree" title="coreBN.models.JunctionTree"><em>JunctionTree</em></a>) -- model for which inference is to performed</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.calibrate" title="Permalink to this definition"></a></dt>
<dd><p>Calibration using belief propagation in junction tree or clique tree.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sat_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;SAT&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letter_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>                        <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">,</span> <span class="n">sat_cpd</span><span class="p">,</span> <span class="n">letter_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.get_clique_beliefs">
<span class="sig-name descname"><span class="pre">get_clique_beliefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_clique_beliefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.get_clique_beliefs" title="Permalink to this definition"></a></dt>
<dd><p>Returns clique beliefs. Should be called after the clique tree (or
junction tree) is calibrated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.get_cliques">
<span class="sig-name descname"><span class="pre">get_cliques</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_cliques"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.get_cliques" title="Permalink to this definition"></a></dt>
<dd><p>Returns cliques used for belief propagation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.get_sepset_beliefs">
<span class="sig-name descname"><span class="pre">get_sepset_beliefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_sepset_beliefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.get_sepset_beliefs" title="Permalink to this definition"></a></dt>
<dd><p>Returns sepset beliefs. Should be called after clique tree (or junction
tree) is calibrated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.map_query">
<span class="sig-name descname"><span class="pre">map_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.map_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.map_query" title="Permalink to this definition"></a></dt>
<dd><p>MAP Query method using belief propagation.</p>
<p>Note: When multiple variables are passed, it returns the map_query for each
of them individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_a</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_r</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_j</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_q</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_l</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_g</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_a</span><span class="p">,</span> <span class="n">cpd_r</span><span class="p">,</span> <span class="n">cpd_j</span><span class="p">,</span> <span class="n">cpd_q</span><span class="p">,</span> <span class="n">cpd_l</span><span class="p">,</span> <span class="n">cpd_g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">bayesian_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.max_calibrate">
<span class="sig-name descname"><span class="pre">max_calibrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.max_calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.max_calibrate" title="Permalink to this definition"></a></dt>
<dd><p>Max-calibration of the junction tree using belief propagation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sat_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;SAT&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letter_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>                        <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">,</span> <span class="n">sat_cpd</span><span class="p">,</span> <span class="n">letter_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span><span class="o">.</span><span class="n">max_calibrate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.BeliefPropagation.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.BeliefPropagation.query" title="Permalink to this definition"></a></dt>
<dd><p>Query method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em>) -- If True, returns a Joint Distribution over <cite>variables</cite>.
If False, returns a dict of distributions over each of the <cite>variables</cite>.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_a</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_r</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_j</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_q</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_l</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_g</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_a</span><span class="p">,</span> <span class="n">cpd_r</span><span class="p">,</span> <span class="n">cpd_j</span><span class="p">,</span> <span class="n">cpd_q</span><span class="p">,</span> <span class="n">cpd_l</span><span class="p">,</span> <span class="n">cpd_g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">bayesian_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.ExactInference.</span></span><span class="sig-name descname"><span class="pre">VariableElimination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination.induced_graph">
<span class="sig-name descname"><span class="pre">induced_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.induced_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination.induced_graph" title="Permalink to this definition"></a></dt>
<dd><p>Returns the induced graph formed by running Variable Elimination on the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elimination_order</strong> (<em>list</em><em>, </em><em>array like</em>) -- List of variables in the order in which they are to be eliminated.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">induced_graph</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination.induced_width">
<span class="sig-name descname"><span class="pre">induced_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.induced_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination.induced_width" title="Permalink to this definition"></a></dt>
<dd><p>Returns the width (integer) of the induced graph formed by running Variable Elimination on the network.
The width is the defined as the number of nodes in the largest clique in the graph minus 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elimination_order</strong> (<em>list</em><em>, </em><em>array like</em>) -- List of variables in the order in which they are to be eliminated.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">induced_width</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination.map_query">
<span class="sig-name descname"><span class="pre">map_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MinFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.map_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination.map_query" title="Permalink to this definition"></a></dt>
<dd><p>Computes the MAP Query over the variables given the evidence.</p>
<p>Note: When multiple variables are passed, it returns the map_query for each
of them individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables over which we want to compute the max-marginal.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>elimination_order</strong> (<em>list</em>) -- order of variable eliminations (if nothing is provided) order is
computed automatically</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination.max_marginal">
<span class="sig-name descname"><span class="pre">max_marginal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MinFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.max_marginal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination.max_marginal" title="Permalink to this definition"></a></dt>
<dd><p>Computes the max-marginal over the variables given the evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables over which we want to compute the max-marginal.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>elimination_order</strong> (<em>list</em>) -- order of variable eliminations (if nothing is provided) order is
computed automatically</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">max_marginal</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ExactInference.VariableElimination.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greedy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ExactInference.VariableElimination.query" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>elimination_order</strong> (<em>str</em><em> or </em><em>list</em><em> (</em><em>default='greedy'</em><em>)</em>) -- Order in which to eliminate the variables in the algorithm. If list is provided,
should contain all variables in the model except the ones in <cite>variables</cite>. str options
are: <cite>greedy</cite>, <cite>WeightedMinFill</cite>, <cite>MinNeighbors</cite>, <cite>MinWeight</cite>, <cite>MinFill</cite>. Please
refer <a class="reference external" href="https://core.org/exact_infer/ve.html#module-core.inference.EliminationOrder">https://core.org/exact_infer/ve.html#module-core.inference.EliminationOrder</a>
for details.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- If True, returns a Joint Distribution over <cite>variables</cite>.
If False, returns a dict of distributions over each of the <cite>variables</cite>.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.inference.base">
<span id="corebn-inference-base-module"></span><h2>coreBN.inference.base module<a class="headerlink" href="#module-coreBN.inference.base" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.base.Inference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.base.</span></span><span class="sig-name descname"><span class="pre">Inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/base.html#Inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.base.Inference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all inference algorithms.</p>
<p>Converts BayesianNetwork and MarkovNetwork to a uniform representation so that inference
algorithms can be applied. Also it checks if all the associated CPDs / Factors are
consistent with the model.</p>
<p>Initialize inference for a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>coreBN.models.BayesianNetwork</em></a><em> or </em><a class="reference internal" href="coreBN.models.html#coreBN.models.MarkovNetwork" title="coreBN.models.MarkovNetwork"><em>coreBN.models.MarkovNetwork</em></a><em> or </em><em>coreBN.models.NoisyOrModel</em>) -- model for which to initialize the inference object.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">Inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Inference</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">MarkovNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span> <span class="o">=</span> <span class="n">MarkovNetwork</span><span class="p">([(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charles&#39;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s1">&#39;Charles&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Debbie&#39;</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_a_b</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_b_c</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charles&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_c_d</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Charles&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_d_a</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Debbie&#39;</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factor_a_b</span><span class="p">,</span> <span class="n">factor_b_c</span><span class="p">,</span> <span class="n">factor_c_d</span><span class="p">,</span> <span class="n">factor_d_a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Inference</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coreBN.inference.dbn_inference">
<span id="corebn-inference-dbn-inference-module"></span><h2>coreBN.inference.dbn_inference module<a class="headerlink" href="#module-coreBN.inference.dbn_inference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.dbn_inference.DBNInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.dbn_inference.</span></span><span class="sig-name descname"><span class="pre">DBNInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.dbn_inference.DBNInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.dbn_inference.DBNInference.backward_inference">
<span class="sig-name descname"><span class="pre">backward_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.backward_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.dbn_inference.DBNInference.backward_inference" title="Permalink to this definition"></a></dt>
<dd><p>Backward inference method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">backward_inference</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.66594382, 0.33405618])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.dbn_inference.DBNInference.forward_inference">
<span class="sig-name descname"><span class="pre">forward_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.forward_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.dbn_inference.DBNInference.forward_inference" title="Permalink to this definition"></a></dt>
<dd><p>Forward inference method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">forward_inference</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.76738736, 0.23261264])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.dbn_inference.DBNInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exact'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.dbn_inference.DBNInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Query method for Dynamic Bayesian Network using Interface Algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">query</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.66594382, 0.33405618])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.inference">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-coreBN.inference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">ApproxInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference.get_distribution">
<span class="sig-name descname"><span class="pre">get_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference.get_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference.get_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Computes distribution of <cite>variables</cite> from given data <cite>samples</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>pandas.DataFrame</em>) -- A dataframe of samples generated from the model.</p></li>
<li><p><strong>variables</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of variables whose distribution needs to be computed.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em>) -- If joint=True, computes the joint distribution over <cite>variables</cite>.
Else, returns a dict with marginal distribution of each variable in
<cite>variables</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.ApproxInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ApproxInference.html#ApproxInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.ApproxInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Method for doing approximate inference based on sampling in Bayesian
Networks and Dynamic Bayesian Networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- List of variables for which the probability distribution needs to be calculated.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) -- The number of samples to generate for computing the distributions. Higher <cite>n_samples</cite>
results in more accurate results at the cost of more computation time.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- The observed values. A dict key, value pair of the form {var: state_name}.</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default: None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual/soft
evidence.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- If True, shows a progress bar when generating samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Probability distribution</strong> -- The queried probability distribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="coreBN.factors.discrete.html#coreBN.factors.discrete.TabularCPD" title="coreBN.factors.discrete.TabularCPD">coreBN.factors.discrete.TabularCPD</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">ApproxInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span> <span class="o">=</span> <span class="n">ApproxInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;HISTORY&quot;</span><span class="p">])</span>
<span class="go">&lt;DiscreteFactor representing phi(HISTORY:2) at 0x7f92d9f5b910&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">BeliefPropagation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<p>Class for performing inference using Belief Propagation method.</p>
<p>Creates a Junction Tree or Clique Tree (JunctionTree class) for the input
probabilistic graphical model and performs calibration of the junction tree
so formed using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>BayesianNetwork</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.MarkovNetwork" title="coreBN.models.MarkovNetwork"><em>MarkovNetwork</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.FactorGraph" title="coreBN.models.FactorGraph"><em>FactorGraph</em></a><em>, </em><a class="reference internal" href="coreBN.models.html#coreBN.models.JunctionTree" title="coreBN.models.JunctionTree"><em>JunctionTree</em></a>) -- model for which inference is to performed</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.calibrate">
<span class="sig-name descname"><span class="pre">calibrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.calibrate" title="Permalink to this definition"></a></dt>
<dd><p>Calibration using belief propagation in junction tree or clique tree.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sat_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;SAT&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letter_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>                        <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">,</span> <span class="n">sat_cpd</span><span class="p">,</span> <span class="n">letter_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.get_clique_beliefs">
<span class="sig-name descname"><span class="pre">get_clique_beliefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_clique_beliefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.get_clique_beliefs" title="Permalink to this definition"></a></dt>
<dd><p>Returns clique beliefs. Should be called after the clique tree (or
junction tree) is calibrated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.get_cliques">
<span class="sig-name descname"><span class="pre">get_cliques</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_cliques"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.get_cliques" title="Permalink to this definition"></a></dt>
<dd><p>Returns cliques used for belief propagation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.get_sepset_beliefs">
<span class="sig-name descname"><span class="pre">get_sepset_beliefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.get_sepset_beliefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.get_sepset_beliefs" title="Permalink to this definition"></a></dt>
<dd><p>Returns sepset beliefs. Should be called after clique tree (or junction
tree) is calibrated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.map_query">
<span class="sig-name descname"><span class="pre">map_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.map_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.map_query" title="Permalink to this definition"></a></dt>
<dd><p>MAP Query method using belief propagation.</p>
<p>Note: When multiple variables are passed, it returns the map_query for each
of them individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_a</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_r</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_j</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_q</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_l</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_g</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_a</span><span class="p">,</span> <span class="n">cpd_r</span><span class="p">,</span> <span class="n">cpd_j</span><span class="p">,</span> <span class="n">cpd_q</span><span class="p">,</span> <span class="n">cpd_l</span><span class="p">,</span> <span class="n">cpd_g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">bayesian_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.max_calibrate">
<span class="sig-name descname"><span class="pre">max_calibrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.max_calibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.max_calibrate" title="Permalink to this definition"></a></dt>
<dd><p>Max-calibration of the junction tree using belief propagation.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span>
<span class="gp">... </span>                   <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;SAT&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="s1">&#39;letter&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                        <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span>
<span class="gp">... </span>                       <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sat_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;SAT&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">letter_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>                        <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">,</span> <span class="n">sat_cpd</span><span class="p">,</span> <span class="n">letter_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bp</span><span class="o">.</span><span class="n">max_calibrate</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.BeliefPropagation.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#BeliefPropagation.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.BeliefPropagation.query" title="Permalink to this definition"></a></dt>
<dd><p>Query method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em>) -- If True, returns a Joint Distribution over <cite>variables</cite>.
If False, returns a dict of distributions over each of the <cite>variables</cite>.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">BeliefPropagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                <span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_a</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_r</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_j</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_q</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_l</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]],</span>
<span class="gp">... </span>                   <span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cpd_g</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bayesian_model</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_a</span><span class="p">,</span> <span class="n">cpd_r</span><span class="p">,</span> <span class="n">cpd_j</span><span class="p">,</span> <span class="n">cpd_q</span><span class="p">,</span> <span class="n">cpd_l</span><span class="p">,</span> <span class="n">cpd_g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span> <span class="o">=</span> <span class="n">BeliefPropagation</span><span class="p">(</span><span class="n">bayesian_model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">belief_propagation</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">],</span>
<span class="gp">... </span>                         <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">CausalInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This is an inference class for performing Causal Inference over Bayesian Networks or Structural Equation Models.</p>
<dl class="simple">
<dt>This class will accept queries of the form: P(Y | do(X)) and utilize its methods to provide an estimand which:</dt><dd><ul class="simple">
<li><p>Identifies adjustment variables</p></li>
<li><p>Backdoor Adjustment</p></li>
<li><p>Front Door Adjustment</p></li>
<li><p>Instrumental Variable Adjustment</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>CausalGraph</em>) -- The model that we'll perform inference over.</p></li>
<li><p><strong>set_nodes</strong> (<em>list</em><em>[</em><em>node:str</em><em>] or </em><em>None</em>) -- A list (or set/tuple) of nodes in the Bayesian Network which have been set to a specific value per the
do-operator.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Create a small Bayesian Network.
&gt;&gt;&gt; from coreBN.models import BayesianNetwork
&gt;&gt;&gt; game = BayesianNetwork([('X', 'A'),
...                         ('A', 'Y'),
...                         ('A', 'B')])</p>
<p>Load the graph into the CausalInference object to make causal queries.
&gt;&gt;&gt; from coreBN.inference.CausalInference import CausalInference
&gt;&gt;&gt; inference = CausalInference(game)
&gt;&gt;&gt; inference.get_all_backdoor_adjustment_sets(X=&quot;X&quot;, Y=&quot;Y&quot;)
&gt;&gt;&gt; inference.get_all_frontdoor_adjustment_sets(X=&quot;X&quot;, Y=&quot;Y&quot;)</p>
<p class="rubric">References</p>
<p>'Causality: Models, Reasoning, and Inference' - Judea Pearl (2000)</p>
<p>Many thanks to &#64;ijmbarr for their implementation of Causal Graphical models available on GitHub: <a class="reference external" href="https://github.com/ijmbarr/causalgraphicalmodels">https://github.com/ijmbarr/causalgraphicalmodels</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.estimate_ate">
<span class="sig-name descname"><span class="pre">estimate_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimand_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'smallest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.estimate_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.estimate_ate" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the average treatment effect (ATE) of X on Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) -- All observed data for this Bayesian Network.</p></li>
<li><p><strong>estimand_strategy</strong> (<em>str</em><em> or </em><em>frozenset</em>) -- <p>Either specify a specific backdoor adjustment set or a strategy.
The available options are:</p>
<blockquote>
<div><dl class="simple">
<dt>smallest:</dt><dd><p>Use the smallest estimand of observed variables</p>
</dd>
<dt>all:</dt><dd><p>Estimate the ATE from each identified estimand</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>estimator_type</strong> (<em>str</em>) -- <p>The type of model to be used to estimate the ATE.
All of the linear regression classes in statsmodels are available including:</p>
<blockquote>
<div><ul>
<li><p>GLS: generalized least squares for arbitrary covariance</p></li>
<li><p>OLS: ordinary least square of i.i.d. errors</p></li>
<li><p>WLS: weighted least squares for heteroskedastic error</p></li>
</ul>
</div></blockquote>
<p>Specify them with their acronym (e.g. &quot;OLS&quot;) or simple &quot;linear&quot; as an alias for OLS.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) -- <p>Keyward arguments specific to the selected estimator.
linear:</p>
<blockquote>
<div><dl class="simple">
<dt>missing: str</dt><dd><p>Available options are &quot;none&quot;, &quot;drop&quot;, or &quot;raise&quot;</p>
</dd>
</dl>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The average treatment effect</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">estimate_ate</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">estimator_type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.get_all_backdoor_adjustment_sets">
<span class="sig-name descname"><span class="pre">get_all_backdoor_adjustment_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_all_backdoor_adjustment_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.get_all_backdoor_adjustment_sets" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of all adjustment sets per the back-door criterion.</p>
<dl class="simple">
<dt>A set of variables Z satisfies the back-door criterion relative to an ordered pair of variabies (Xi, Xj) in a DAG G if:</dt><dd><ol class="lowerroman simple">
<li><p>no node in Z is a descendant of Xi; and</p></li>
<li><p>Z blocks every path between Xi and Xj that contains an arrow into Xi.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>frozenset</strong> (<em>A frozenset of frozensets</em>)</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">get_all_backdoor_adjustment_sets</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="go">frozenset()</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>&quot;Causality: Models, Reasoning, and Inference&quot;, Judea Pearl (2000). p.79.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.get_all_frontdoor_adjustment_sets">
<span class="sig-name descname"><span class="pre">get_all_frontdoor_adjustment_sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_all_frontdoor_adjustment_sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.get_all_frontdoor_adjustment_sets" title="Permalink to this definition"></a></dt>
<dd><p>Identify possible sets of variables, Z, which satisify the front-door criterion relative to given X and Y.</p>
<dl class="simple">
<dt>Z satisifies the front-door critierion if:</dt><dd><ol class="lowerroman simple">
<li><p>Z intercepts all directed paths from X to Y</p></li>
<li><p>there is no backdoor path from X to Z</p></li>
<li><p>all back-door paths from Z to Y are blocked by X</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frozenset</strong></p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>a frozenset of frozensets</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Causality: Models, Reasoning, and Inference, Judea Pearl (2000). p.82.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.get_distribution">
<span class="sig-name descname"><span class="pre">get_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.get_distribution" title="Permalink to this definition"></a></dt>
<dd><p>Returns a string representing the factorized distribution implied by the CGM.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.get_minimal_adjustment_set">
<span class="sig-name descname"><span class="pre">get_minimal_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_minimal_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.get_minimal_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Method to test whether <cite>adjustment_set</cite> is a valid adjustment set for
identifying the causal effect of <cite>X</cite> on <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em><em> (</em><em>variable name</em><em>)</em>) -- The cause/exposure variables.</p></li>
<li><p><strong>Y</strong> (<em>str</em><em> (</em><em>variable name</em><em>)</em>) -- The outcome variable</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Minimal adjustment set</strong> -- A set of variables which are the minimal possible adjustment set. If
None, no adjutment set is possible.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set or None</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.get_proper_backdoor_graph">
<span class="sig-name descname"><span class="pre">get_proper_backdoor_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.get_proper_backdoor_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.get_proper_backdoor_graph" title="Permalink to this definition"></a></dt>
<dd><p>Returns a proper backdoor graph for the exposure <cite>X</cite> and outcome <cite>Y</cite>.
A proper backdoor graph is a graph which remove the first edge of every
proper causal path from <cite>X</cite> to <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of exposure variables.</p></li>
<li><p><strong>Y</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- A list of outcome variables</p></li>
<li><p><strong>inplace</strong> (<em>boolean</em>) -- If inplace is True, modifies the object itself. Otherwise retuns
a modified copy of self.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">CausalInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;z1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;z1&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s2">&quot;z2&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span><span class="o">.</span><span class="n">get_proper_backdoor_graph</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">],</span> <span class="n">Y</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y1&quot;</span><span class="p">,</span> <span class="s2">&quot;y2&quot;</span><span class="p">])</span>
<span class="go">&lt;coreBN.models.BayesianNetwork.BayesianNetwork at 0x7fba501ad940&gt;</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.is_valid_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjustment_set</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.is_valid_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Method to test whether <cite>adjustment_set</cite> is a valid adjustment set for
identifying the causal effect of <cite>X</cite> on <cite>Y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of cause variables.</p></li>
<li><p><strong>Y</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of predictor variables.</p></li>
<li><p><strong>adjustment_set</strong> (<em>list</em><em> (</em><em>array-like</em><em>)</em>) -- The set of variables for which to test whether they satisfy the
adjustment set criteria.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is valid adjustment set</strong> -- Returns True if <cite>adjustment_set</cite> is a valid adjustment set for
identifying the effect of <cite>X</cite> on <cite>Y</cite>. Else returns False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">CausalInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;y1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;x1&quot;</span><span class="p">,</span> <span class="s2">&quot;z1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;z1&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s2">&quot;z2&quot;</span><span class="p">,</span> <span class="s2">&quot;x2&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;y2&quot;</span><span class="p">,</span> <span class="s2">&quot;z2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_infer</span><span class="o">.</span><span class="n">is_valid_adjustment_set</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">],</span> <span class="n">Y</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">],</span> <span class="n">adjustment_set</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z1&#39;</span><span class="p">,</span> <span class="s1">&#39;z2&#39;</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>[1] Perkovic, Emilija, et al. &quot;Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs.&quot; The Journal of Machine Learning Research 18.1 (2017): 8132-8193.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.is_valid_backdoor_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_backdoor_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_backdoor_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.is_valid_backdoor_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Test whether Z is a valid backdoor adjustment set for estimating the causal impact of X on Y.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>Z</strong> (<em>str</em><em> or </em><em>set</em><em>[</em><em>str</em><em>]</em>) -- Adjustment variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is a valid backdoor adjustment set</strong> -- True if Z is a valid backdoor adjustment set else False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">game1</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">),</span>
<span class="gp">... </span>                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">game1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">is_valid_backdoor_adjustment_set</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.is_valid_frontdoor_adjustment_set">
<span class="sig-name descname"><span class="pre">is_valid_frontdoor_adjustment_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.is_valid_frontdoor_adjustment_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.is_valid_frontdoor_adjustment_set" title="Permalink to this definition"></a></dt>
<dd><p>Test whether Z is a valid frontdoor adjustment set for estimating the causal impact of X on Y via the frontdoor
adjustment formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>str</em>) -- Intervention Variable</p></li>
<li><p><strong>Y</strong> (<em>str</em>) -- Target Variable</p></li>
<li><p><strong>Z</strong> (<em>set</em>) -- Adjustment variables</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Is valid frontdoor adjusment</strong> -- True if Z is a valid frontdoor adjustment set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adjustment_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inference_algo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ve'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Performs a query on the model of the form <span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span> where <span class="math notranslate nohighlight">\(X\)</span>
is <cite>variables</cite>, <span class="math notranslate nohighlight">\(Y\)</span> is <cite>do</cite> and <cite>Z</cite> is the <cite>evidence</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables in the query i.e. <cite>X</cite> in <span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span>.</p></li>
<li><p><strong>do</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- Dictionary of the form {variable_name: variable_state} representing
the variables on which to apply the do operation i.e. <cite>Y</cite> in
<span class="math notranslate nohighlight">\(P(X | do(Y), Z)\)</span>.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em><em> (</em><em>default: None</em><em>)</em>) -- Dictionary of the form {variable_name: variable_state} repesenting
the conditional variables in the query i.e. <cite>Z</cite> in <span class="math notranslate nohighlight">\(P(X |
do(Y), Z)\)</span>.</p></li>
<li><p><strong>adjustment_set</strong> (<em>str</em><em> or </em><em>list</em><em> (</em><em>default=None</em><em>)</em>) -- Specifies the adjustment set to use. If None, uses the parents of the
do variables as the adjustment set.</p></li>
<li><p><strong>inference_algo</strong> (<em>str</em><em> or </em><em>coreBN.inference.Inference instance</em>) -- The inference algorithm to use to compute the probability values.
String options are: 1) ve: Variable Elimination 2) bp: Belief
Propagation.</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) -- Additional paramters which needs to be passed to inference
algorithms.  Please refer to the coreBN.inference.Inference for
details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Queried distribution</strong> -- A factor object representing the joint distribution over the variables in <cite>variables</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coreBN.factor.discrete.DiscreteFactor</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s1">&#39;alarm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span> <span class="o">=</span> <span class="n">CausalInference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">infer</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">],</span> <span class="n">do</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;CVP&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">},</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;HR&#39;</span><span class="p">:</span> <span class="s1">&#39;LOW&#39;</span><span class="p">})</span>
<span class="go">&lt;DiscreteFactor representing phi(HISTORY:2) at 0x7f4e0874c2e0&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.CausalInference.simple_decision">
<span class="sig-name descname"><span class="pre">simple_decision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adjustment_sets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/CausalInference.html#CausalInference.simple_decision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.CausalInference.simple_decision" title="Permalink to this definition"></a></dt>
<dd><p>Selects the smallest set from provided adjustment sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>adjustment_sets</strong> (<em>iterable</em>) -- A frozenset or list of valid adjustment sets</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>frozenset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.DBNInference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">DBNInference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.DBNInference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.DBNInference.backward_inference">
<span class="sig-name descname"><span class="pre">backward_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.backward_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.DBNInference.backward_inference" title="Permalink to this definition"></a></dt>
<dd><p>Backward inference method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">backward_inference</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.66594382, 0.33405618])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.DBNInference.forward_inference">
<span class="sig-name descname"><span class="pre">forward_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.forward_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.DBNInference.forward_inference" title="Permalink to this definition"></a></dt>
<dd><p>Forward inference method using belief propagation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">forward_inference</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.76738736, 0.23261264])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.DBNInference.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exact'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/dbn_inference.html#DBNInference.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.DBNInference.query" title="Permalink to this definition"></a></dt>
<dd><p>Query method for Dynamic Bayesian Network using Interface Algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">DynamicBayesianNetwork</span> <span class="k">as</span> <span class="n">DBN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">DBNInference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span> <span class="o">=</span> <span class="n">DBN</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_start_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_i_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="gp">... </span>                                   <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_trans_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">((</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
<span class="gp">... </span>                                       <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]],</span>
<span class="gp">... </span>                     <span class="n">evidence</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="gp">... </span>                     <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">z_start_cpd</span><span class="p">,</span> <span class="n">z_trans_cpd</span><span class="p">,</span> <span class="n">x_i_cpd</span><span class="p">,</span> <span class="n">y_i_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbnet</span><span class="o">.</span><span class="n">initialize_initial_state</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span> <span class="o">=</span> <span class="n">DBNInference</span><span class="p">(</span><span class="n">dbnet</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dbn_inf</span><span class="o">.</span><span class="n">query</span><span class="p">([(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">{(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span><span class="mi">1</span><span class="p">})[(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span>
<span class="go">array([0.66594382, 0.33405618])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.Inference">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">Inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/base.html#Inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.Inference" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all inference algorithms.</p>
<p>Converts BayesianNetwork and MarkovNetwork to a uniform representation so that inference
algorithms can be applied. Also it checks if all the associated CPDs / Factors are
consistent with the model.</p>
<p>Initialize inference for a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>coreBN.models.BayesianNetwork</em></a><em> or </em><a class="reference internal" href="coreBN.models.html#coreBN.models.MarkovNetwork" title="coreBN.models.MarkovNetwork"><em>coreBN.models.MarkovNetwork</em></a><em> or </em><em>coreBN.models.NoisyOrModel</em>) -- model for which to initialize the inference object.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">Inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="s1">&#39;grade&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diff_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">intel_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;intel&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grade_cpd</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
<span class="gp">... </span>                       <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;diff&#39;</span><span class="p">,</span> <span class="s1">&#39;intel&#39;</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">diff_cpd</span><span class="p">,</span> <span class="n">intel_cpd</span><span class="p">,</span> <span class="n">grade_cpd</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Inference</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">MarkovNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.factors.discrete</span> <span class="kn">import</span> <span class="n">DiscreteFactor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span> <span class="o">=</span> <span class="n">MarkovNetwork</span><span class="p">([(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charles&#39;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="s1">&#39;Charles&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Debbie&#39;</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_a_b</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_b_c</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Charles&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_c_d</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Charles&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor_d_a</span> <span class="o">=</span> <span class="n">DiscreteFactor</span><span class="p">([</span><span class="s1">&#39;Debbie&#39;</span><span class="p">,</span> <span class="s1">&#39;Alice&#39;</span><span class="p">],</span> <span class="n">cardinality</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">student</span><span class="o">.</span><span class="n">add_factors</span><span class="p">(</span><span class="n">factor_a_b</span><span class="p">,</span> <span class="n">factor_b_c</span><span class="p">,</span> <span class="n">factor_c_d</span><span class="p">,</span> <span class="n">factor_d_a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Inference</span><span class="p">(</span><span class="n">student</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.inference.</span></span><span class="sig-name descname"><span class="pre">VariableElimination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#coreBN.inference.base.Inference" title="coreBN.inference.base.Inference"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inference</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination.induced_graph">
<span class="sig-name descname"><span class="pre">induced_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.induced_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination.induced_graph" title="Permalink to this definition"></a></dt>
<dd><p>Returns the induced graph formed by running Variable Elimination on the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elimination_order</strong> (<em>list</em><em>, </em><em>array like</em>) -- List of variables in the order in which they are to be eliminated.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">induced_graph</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination.induced_width">
<span class="sig-name descname"><span class="pre">induced_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.induced_width"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination.induced_width" title="Permalink to this definition"></a></dt>
<dd><p>Returns the width (integer) of the induced graph formed by running Variable Elimination on the network.
The width is the defined as the number of nodes in the largest clique in the graph minus 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elimination_order</strong> (<em>list</em><em>, </em><em>array like</em>) -- List of variables in the order in which they are to be eliminated.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span><span class="o">.</span><span class="n">induced_width</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination.map_query">
<span class="sig-name descname"><span class="pre">map_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MinFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.map_query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination.map_query" title="Permalink to this definition"></a></dt>
<dd><p>Computes the MAP Query over the variables given the evidence.</p>
<p>Note: When multiple variables are passed, it returns the map_query for each
of them individually.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables over which we want to compute the max-marginal.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>elimination_order</strong> (<em>list</em>) -- order of variable eliminations (if nothing is provided) order is
computed automatically</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">map_query</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination.max_marginal">
<span class="sig-name descname"><span class="pre">max_marginal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MinFill'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.max_marginal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination.max_marginal" title="Permalink to this definition"></a></dt>
<dd><p>Computes the max-marginal over the variables given the evidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables over which we want to compute the max-marginal.</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>elimination_order</strong> (<em>list</em>) -- order of variable eliminations (if nothing is provided) order is
computed automatically</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">max_marginal</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.inference.VariableElimination.query">
<span class="sig-name descname"><span class="pre">query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virtual_evidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elimination_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'greedy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">joint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/inference/ExactInference.html#VariableElimination.query"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.inference.VariableElimination.query" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variables</strong> (<em>list</em>) -- list of variables for which you want to compute the probability</p></li>
<li><p><strong>evidence</strong> (<em>dict</em>) -- a dict key, value pair as {var: state_of_var_observed}
None if no evidence</p></li>
<li><p><strong>virtual_evidence</strong> (<em>list</em><em> (</em><em>default:None</em><em>)</em>) -- A list of coreBN.factors.discrete.TabularCPD representing the virtual
evidences.</p></li>
<li><p><strong>elimination_order</strong> (<em>str</em><em> or </em><em>list</em><em> (</em><em>default='greedy'</em><em>)</em>) -- Order in which to eliminate the variables in the algorithm. If list is provided,
should contain all variables in the model except the ones in <cite>variables</cite>. str options
are: <cite>greedy</cite>, <cite>WeightedMinFill</cite>, <cite>MinNeighbors</cite>, <cite>MinWeight</cite>, <cite>MinFill</cite>. Please
refer <a class="reference external" href="https://core.org/exact_infer/ve.html#module-core.inference.EliminationOrder">https://core.org/exact_infer/ve.html#module-core.inference.EliminationOrder</a>
for details.</p></li>
<li><p><strong>joint</strong> (<em>boolean</em><em> (</em><em>default: True</em><em>)</em>) -- If True, returns a Joint Distribution over <cite>variables</cite>.
If False, returns a dict of distributions over each of the <cite>variables</cite>.</p></li>
<li><p><strong>show_progress</strong> (<em>boolean</em>) -- If True, shows a progress bar.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.models</span> <span class="kn">import</span> <span class="n">BayesianNetwork</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span>
<span class="gp">... </span>                      <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">BayesianNetwork</span><span class="p">([(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inference</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phi_query</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">query</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coreBN.independencies.html" class="btn btn-neutral float-left" title="coreBN.independencies package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coreBN.metrics.html" class="btn btn-neutral float-right" title="coreBN.metrics package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Serafina Di Gioia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>