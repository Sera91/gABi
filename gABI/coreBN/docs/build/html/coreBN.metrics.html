<!DOCTYPE html>
<html class="writer-html5" lang="English/Python">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>coreBN.metrics package &mdash; gABi 00.00.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="coreBN.models package" href="coreBN.models.html" />
    <link rel="prev" title="coreBN.inference package" href="coreBN.inference.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            gABi
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">coreBN</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="coreBN.html">coreBN package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="coreBN.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="coreBN.CItests.html">coreBN.CItests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.IO.html">coreBN.IO package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.base.html">coreBN.base package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.estimators.html">coreBN.estimators package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.extern.html">coreBN.extern package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.factors.html">coreBN.factors package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.independencies.html">coreBN.independencies package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.inference.html">coreBN.inference package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">coreBN.metrics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.models.html">coreBN.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.sampling.html">coreBN.sampling package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.tests.html">coreBN.tests package</a></li>
<li class="toctree-l4"><a class="reference internal" href="coreBN.utils.html">coreBN.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN.global_vars">coreBN.global_vars module</a></li>
<li class="toctree-l3"><a class="reference internal" href="coreBN.html#module-coreBN">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gABi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">coreBN</a></li>
          <li class="breadcrumb-item"><a href="coreBN.html">coreBN package</a></li>
      <li class="breadcrumb-item active">coreBN.metrics package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/coreBN.metrics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="corebn-metrics-package">
<h1>coreBN.metrics package<a class="headerlink" href="#corebn-metrics-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-coreBN.metrics.bn_inference">
<span id="corebn-metrics-bn-inference-module"></span><h2>coreBN.metrics.bn_inference module<a class="headerlink" href="#module-coreBN.metrics.bn_inference" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="coreBN.metrics.bn_inference.BayesianModelProbability">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">coreBN.metrics.bn_inference.</span></span><span class="sig-name descname"><span class="pre">BayesianModelProbability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/bn_inference.html#BayesianModelProbability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.bn_inference.BayesianModelProbability" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="coreBN.sampling.html#coreBN.sampling.base.BayesianModelInference" title="coreBN.sampling.base.BayesianModelInference"><code class="xref py py-class docutils literal notranslate"><span class="pre">BayesianModelInference</span></code></a></p>
<p>Class to calculate probability (pmf) values specific to Bayesian Models</p>
<dl class="py method">
<dt class="sig sig-object py" id="coreBN.metrics.bn_inference.BayesianModelProbability.log_probability">
<span class="sig-name descname"><span class="pre">log_probability</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/bn_inference.html#BayesianModelProbability.log_probability"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.bn_inference.BayesianModelProbability.log_probability" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the logarithmic probability of each point in a data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas dataframe OR array_like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) -- List of n_features-dimensional data points.  Each row
corresponds to a single data point.</p></li>
<li><p><strong>ordering</strong> (<em>list</em>) -- ordering of columns in data, used by the Bayesian model.
default is topological ordering used by model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Log probability of each datapoint</strong> -- The array of log(density) evaluations. These are normalized to be
probability densities, so values will be low for high-dimensional
data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array (n_samples,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="coreBN.metrics.bn_inference.BayesianModelProbability.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/bn_inference.html#BayesianModelProbability.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.bn_inference.BayesianModelProbability.score" title="Permalink to this definition"></a></dt>
<dd><p>Compute the total log probability density under the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas dataframe OR array_like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) -- List of n_features-dimensional data points.  Each row
corresponds to a single data point.</p></li>
<li><p><strong>ordering</strong> (<em>list</em>) -- ordering of columns in data, used by the Bayesian model.
default is topological ordering used by model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Log-likelihood of data</strong> -- This is normalized to be a probability density, so the value
will be low for high-dimensional data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-coreBN.metrics.metrics">
<span id="corebn-metrics-metrics-module"></span><h2>coreBN.metrics.metrics module<a class="headerlink" href="#module-coreBN.metrics.metrics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.metrics.correlation_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.metrics.</span></span><span class="sig-name descname"><span class="pre">correlation_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test='chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level=0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score=&lt;function</span> <span class="pre">f1_score&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_summary=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#correlation_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.metrics.correlation_score" title="Permalink to this definition"></a></dt>
<dd><p>Function to score how well the model structure represents the correlations
in the data. The model doesn't need to be parameterized for this score.</p>
<p>A Bayesian Network or DAG has d-connection property which can be used to
determine which variables are correlated according to the model. This
function uses this d-connection/d-separation property to compare the model
with variable correlations in a given dataset. For every pair of variables
in the dataset, a correlation test (specified by <cite>test</cite> argument) is done.
We say that any two variables are correlated if the test's p-value &lt;
significance_level. The same pair of variables are then tested whether they
are d-connected in the network structure or not. Finally a metric specified
by <cite>score</cite> is computed by using the correlation test as the true value and
d-connections as predicted values.</p>
<p>Absense of correlation/d-separation is considered as the positive class for
computing the metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Instance</em><em> of </em><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>coreBN.models.BayesianNetwork</em></a>) -- The model which needs to be tested.</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame instance</em>) -- The dataset against which to test the model structure.</p></li>
<li><p><strong>test</strong> (<em>str</em><em> or </em><em>function</em>) -- The statistical tests to use for determining whether the variables in data
are correlated or not. For discrete variables, the options are: 1) chi_square
2) g_sq 3) log_likelihood 4) freeman_tuckey 5) modified_log_likelihood 6) neyman
7) cressie_read. For continuous variables only one test is available: 1) pearsonr.
A function with the signature fun(X, Y, Z, data) can also be passed which
returns True for uncorrelated and False otherwise.</p></li>
<li><p><strong>significance_level</strong> (<em>float</em>) -- A value between 0 and 1. If p_value &lt; significance_level, the variables are
considered uncorrelated.</p></li>
<li><p><strong>score</strong> (<em>function</em><em> (</em><em>default: f1-score</em><em>)</em>) -- Any classification scoring metric from scikit-learn.
<a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#classification-metrics">https://scikit-learn.org/stable/modules/classes.html#classification-metrics</a></p></li>
<li><p><strong>return_summary</strong> (<em>boolean</em><em> (</em><em>default: False</em><em>)</em>) -- If True, returns a dataframe with details for each of the conditions checked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The specified metric</strong> -- The metric specified by the <cite>score</cite> argument. By defults returns the f1-score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_examples_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">correlation_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alarm</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">alarm</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correlation_score</span><span class="p">(</span><span class="n">alarm</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;chi_square&quot;</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="go">0.911957950065703</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.metrics.log_likelihood_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.metrics.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#log_likelihood_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.metrics.log_likelihood_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes the log-likelihood of a given dataset i.e. P(data | model).</p>
<p>The log-likelihood measure can be used to check how well the specified
model describes the data. This method requires the parameters of the model to be
specified as well. Direct interpretation of this score is difficult but can
be used to compare the fit of two or more models. A higher score means ab
better fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><em>coreBN.models.BayesianNetwork instance</em>) -- The model whose score needs to be computed.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame instance</em>) -- The dataset against which to score the model.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">log_likelihood_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_likelihood_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="go">-103818.57516969478</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.metrics.structure_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.metrics.</span></span><span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bic'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.metrics.structure_score" title="Permalink to this definition"></a></dt>
<dd><p>Uses the standard model scoring methods to give a score for each structure.
The score doesn't have very straight forward interpretebility but can be
used to compare different models. A higher score represents a better fit.
This method only needs the model structure to compute the score and parameters
aren't required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><em>coreBN.models.BayesianNetwork instance</em>) -- The model whose score needs to be computed.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame instance</em>) -- The dataset against which to score the model.</p></li>
<li><p><strong>scoring_method</strong> (<em>str</em><em> ( </em><em>k2</em><em> | </em><em>bdeu</em><em> | </em><em>bds</em><em> | </em><em>bic</em><em> )</em>) -- The following four scoring methods are supported currently: 1) K2Score
2) BDeuScore 3) BDsScore 4) BicScore</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs</em>) -- Any additional parameters parameters that needs to be passed to the
scoring method. Check coreBN.estimators.StructureScore for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model score</strong> -- A score value for the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">structure_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s1">&#39;alarm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;bic&quot;</span><span class="p">)</span>
<span class="go">-106665.9383064447</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-coreBN.metrics">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-coreBN.metrics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.correlation_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.</span></span><span class="sig-name descname"><span class="pre">correlation_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test='chi_square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">significance_level=0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score=&lt;function</span> <span class="pre">f1_score&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_summary=False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#correlation_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.correlation_score" title="Permalink to this definition"></a></dt>
<dd><p>Function to score how well the model structure represents the correlations
in the data. The model doesn't need to be parameterized for this score.</p>
<p>A Bayesian Network or DAG has d-connection property which can be used to
determine which variables are correlated according to the model. This
function uses this d-connection/d-separation property to compare the model
with variable correlations in a given dataset. For every pair of variables
in the dataset, a correlation test (specified by <cite>test</cite> argument) is done.
We say that any two variables are correlated if the test's p-value &lt;
significance_level. The same pair of variables are then tested whether they
are d-connected in the network structure or not. Finally a metric specified
by <cite>score</cite> is computed by using the correlation test as the true value and
d-connections as predicted values.</p>
<p>Absense of correlation/d-separation is considered as the positive class for
computing the metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Instance</em><em> of </em><a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><a class="reference internal" href="coreBN.models.html#coreBN.models.BayesianNetwork" title="coreBN.models.BayesianNetwork"><em>coreBN.models.BayesianNetwork</em></a>) -- The model which needs to be tested.</p></li>
<li><p><strong>data</strong> (<em>pandas.DataFrame instance</em>) -- The dataset against which to test the model structure.</p></li>
<li><p><strong>test</strong> (<em>str</em><em> or </em><em>function</em>) -- The statistical tests to use for determining whether the variables in data
are correlated or not. For discrete variables, the options are: 1) chi_square
2) g_sq 3) log_likelihood 4) freeman_tuckey 5) modified_log_likelihood 6) neyman
7) cressie_read. For continuous variables only one test is available: 1) pearsonr.
A function with the signature fun(X, Y, Z, data) can also be passed which
returns True for uncorrelated and False otherwise.</p></li>
<li><p><strong>significance_level</strong> (<em>float</em>) -- A value between 0 and 1. If p_value &lt; significance_level, the variables are
considered uncorrelated.</p></li>
<li><p><strong>score</strong> (<em>function</em><em> (</em><em>default: f1-score</em><em>)</em>) -- Any classification scoring metric from scikit-learn.
<a class="reference external" href="https://scikit-learn.org/stable/modules/classes.html#classification-metrics">https://scikit-learn.org/stable/modules/classes.html#classification-metrics</a></p></li>
<li><p><strong>return_summary</strong> (<em>boolean</em><em> (</em><em>default: False</em><em>)</em>) -- If True, returns a dataframe with details for each of the conditions checked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>The specified metric</strong> -- The metric specified by the <cite>score</cite> argument. By defults returns the f1-score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_examples_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">correlation_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alarm</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">alarm</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correlation_score</span><span class="p">(</span><span class="n">alarm</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;chi_square&quot;</span><span class="p">,</span> <span class="n">significance_level</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="go">0.911957950065703</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.log_likelihood_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.</span></span><span class="sig-name descname"><span class="pre">log_likelihood_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#log_likelihood_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.log_likelihood_score" title="Permalink to this definition"></a></dt>
<dd><p>Computes the log-likelihood of a given dataset i.e. P(data | model).</p>
<p>The log-likelihood measure can be used to check how well the specified
model describes the data. This method requires the parameters of the model to be
specified as well. Direct interpretation of this score is difficult but can
be used to compare the fit of two or more models. A higher score means ab
better fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><em>coreBN.models.BayesianNetwork instance</em>) -- The model whose score needs to be computed.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame instance</em>) -- The dataset against which to score the model.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">log_likelihood_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s2">&quot;alarm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_likelihood_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="go">-103818.57516969478</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="coreBN.metrics.structure_score">
<span class="sig-prename descclassname"><span class="pre">coreBN.metrics.</span></span><span class="sig-name descname"><span class="pre">structure_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bic'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coreBN/metrics/metrics.html#structure_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#coreBN.metrics.structure_score" title="Permalink to this definition"></a></dt>
<dd><p>Uses the standard model scoring methods to give a score for each structure.
The score doesn't have very straight forward interpretebility but can be
used to compare different models. A higher score represents a better fit.
This method only needs the model structure to compute the score and parameters
aren't required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="coreBN.base.html#coreBN.base.DAG" title="coreBN.base.DAG"><em>coreBN.base.DAG</em></a><em> or </em><em>coreBN.models.BayesianNetwork instance</em>) -- The model whose score needs to be computed.</p></li>
<li><p><strong>data</strong> (<em>pd.DataFrame instance</em>) -- The dataset against which to score the model.</p></li>
<li><p><strong>scoring_method</strong> (<em>str</em><em> ( </em><em>k2</em><em> | </em><em>bdeu</em><em> | </em><em>bds</em><em> | </em><em>bic</em><em> )</em>) -- The following four scoring methods are supported currently: 1) K2Score
2) BDeuScore 3) BDsScore 4) BicScore</p></li>
<li><p><strong>kwargs</strong> (<em>kwargs</em>) -- Any additional parameters parameters that needs to be passed to the
scoring method. Check coreBN.estimators.StructureScore for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Model score</strong> -- A score value for the model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.utils</span> <span class="kn">import</span> <span class="n">get_example_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">coreBN.metrics</span> <span class="kn">import</span> <span class="n">structure_score</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">get_example_model</span><span class="p">(</span><span class="s1">&#39;alarm&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">scoring_method</span><span class="o">=</span><span class="s2">&quot;bic&quot;</span><span class="p">)</span>
<span class="go">-106665.9383064447</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coreBN.inference.html" class="btn btn-neutral float-left" title="coreBN.inference package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="coreBN.models.html" class="btn btn-neutral float-right" title="coreBN.models package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Serafina Di Gioia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>